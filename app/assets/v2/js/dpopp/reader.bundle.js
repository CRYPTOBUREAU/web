/*! For license information please see reader.bundle.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("PassportReader",[],t):"object"==typeof exports?exports.PassportReader=t():e.PassportReader=t()}(self,(()=>(()=>{var e={99:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(117);function o(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}function i(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}function a(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function s(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function c(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function u(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function l(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}function f(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}function h(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),l(e/4294967296>>>0,t,r),l(e>>>0,t,r+4),t}function d(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),f(e>>>0,t,r),f(e/4294967296>>>0,t,r+4),t}t.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},t.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},t.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},t.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},t.writeUint16BE=o,t.writeInt16BE=o,t.writeUint16LE=i,t.writeInt16LE=i,t.readInt32BE=a,t.readUint32BE=s,t.readInt32LE=c,t.readUint32LE=u,t.writeUint32BE=l,t.writeInt32BE=l,t.writeUint32LE=f,t.writeInt32LE=f,t.readInt64BE=function(e,t){void 0===t&&(t=0);var r=a(e,t),n=a(e,t+4);return 4294967296*r+n-4294967296*(n>>31)},t.readUint64BE=function(e,t){return void 0===t&&(t=0),4294967296*s(e,t)+s(e,t+4)},t.readInt64LE=function(e,t){void 0===t&&(t=0);var r=c(e,t);return 4294967296*c(e,t+4)+r-4294967296*(r>>31)},t.readUint64LE=function(e,t){void 0===t&&(t=0);var r=u(e,t);return 4294967296*u(e,t+4)+r},t.writeUint64BE=h,t.writeInt64BE=h,t.writeUint64LE=d,t.writeInt64LE=d,t.readUintBE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,o=1,i=e/8+r-1;i>=r;i--)n+=t[i]*o,o*=256;return n},t.readUintLE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,o=1,i=r;i<r+e/8;i++)n+=t[i]*o,o*=256;return n},t.writeUintBE=function(e,t,r,o){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===o&&(o=0),e%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!n.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,a=e/8+o-1;a>=o;a--)r[a]=t/i&255,i*=256;return r},t.writeUintLE=function(e,t,r,o){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===o&&(o=0),e%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!n.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,a=o;a<o+e/8;a++)r[a]=t/i&255,i*=256;return r},t.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},t.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},t.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},t.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},t.writeFloat32BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e),t},t.writeFloat32LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e,!0),t},t.writeFloat64BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e),t},t.writeFloat64LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e,!0),t}},50:(e,t,r)=>{"use strict";r(416),r(911),r(309);function n(e){var t=new Float64Array(16);if(e)for(var r=0;r<e.length;r++)t[r]=e[r];return t}t.jQ=64,t.KS=64,t.aP=32,new Uint8Array(32)[0]=9;var o=n(),i=n([1]),a=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),s=(n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]));function c(e,t){for(var r=0;r<16;r++)e[r]=0|t[r]}function u(e){for(var t=1,r=0;r<16;r++){var n=e[r]+t+65535;t=Math.floor(n/65536),e[r]=n-65536*t}e[0]+=t-1+37*(t-1)}function l(e,t,r){for(var n=~(r-1),o=0;o<16;o++){var i=n&(e[o]^t[o]);e[o]^=i,t[o]^=i}}function f(e,t){for(var r=n(),o=n(),i=0;i<16;i++)o[i]=t[i];u(o),u(o),u(o);for(var a=0;a<2;a++){for(r[0]=o[0]-65517,i=1;i<15;i++)r[i]=o[i]-65535-(r[i-1]>>16&1),r[i-1]&=65535;r[15]=o[15]-32767-(r[14]>>16&1);var s=r[15]>>16&1;r[14]&=65535,l(o,r,1-s)}for(i=0;i<16;i++)e[2*i]=255&o[i],e[2*i+1]=o[i]>>8}function h(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return f(r,e),f(n,t),function(e,t){for(var r=0,n=0;n<32;n++)r|=e[n]^t[n];return(1&r-1>>>8)-1}(r,n)}function d(e){var t=new Uint8Array(32);return f(t,e),1&t[0]}function p(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function y(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function m(e,t,r){var n,o,i=0,a=0,s=0,c=0,u=0,l=0,f=0,h=0,d=0,p=0,y=0,m=0,w=0,b=0,v=0,g=0,E=0,_=0,S=0,A=0,I=0,x=0,O=0,k=0,C=0,j=0,D=0,T=0,P=0,R=0,N=0,B=r[0],U=r[1],M=r[2],L=r[3],F=r[4],$=r[5],z=r[6],H=r[7],q=r[8],V=r[9],J=r[10],G=r[11],K=r[12],W=r[13],Y=r[14],Z=r[15];i+=(n=t[0])*B,a+=n*U,s+=n*M,c+=n*L,u+=n*F,l+=n*$,f+=n*z,h+=n*H,d+=n*q,p+=n*V,y+=n*J,m+=n*G,w+=n*K,b+=n*W,v+=n*Y,g+=n*Z,a+=(n=t[1])*B,s+=n*U,c+=n*M,u+=n*L,l+=n*F,f+=n*$,h+=n*z,d+=n*H,p+=n*q,y+=n*V,m+=n*J,w+=n*G,b+=n*K,v+=n*W,g+=n*Y,E+=n*Z,s+=(n=t[2])*B,c+=n*U,u+=n*M,l+=n*L,f+=n*F,h+=n*$,d+=n*z,p+=n*H,y+=n*q,m+=n*V,w+=n*J,b+=n*G,v+=n*K,g+=n*W,E+=n*Y,_+=n*Z,c+=(n=t[3])*B,u+=n*U,l+=n*M,f+=n*L,h+=n*F,d+=n*$,p+=n*z,y+=n*H,m+=n*q,w+=n*V,b+=n*J,v+=n*G,g+=n*K,E+=n*W,_+=n*Y,S+=n*Z,u+=(n=t[4])*B,l+=n*U,f+=n*M,h+=n*L,d+=n*F,p+=n*$,y+=n*z,m+=n*H,w+=n*q,b+=n*V,v+=n*J,g+=n*G,E+=n*K,_+=n*W,S+=n*Y,A+=n*Z,l+=(n=t[5])*B,f+=n*U,h+=n*M,d+=n*L,p+=n*F,y+=n*$,m+=n*z,w+=n*H,b+=n*q,v+=n*V,g+=n*J,E+=n*G,_+=n*K,S+=n*W,A+=n*Y,I+=n*Z,f+=(n=t[6])*B,h+=n*U,d+=n*M,p+=n*L,y+=n*F,m+=n*$,w+=n*z,b+=n*H,v+=n*q,g+=n*V,E+=n*J,_+=n*G,S+=n*K,A+=n*W,I+=n*Y,x+=n*Z,h+=(n=t[7])*B,d+=n*U,p+=n*M,y+=n*L,m+=n*F,w+=n*$,b+=n*z,v+=n*H,g+=n*q,E+=n*V,_+=n*J,S+=n*G,A+=n*K,I+=n*W,x+=n*Y,O+=n*Z,d+=(n=t[8])*B,p+=n*U,y+=n*M,m+=n*L,w+=n*F,b+=n*$,v+=n*z,g+=n*H,E+=n*q,_+=n*V,S+=n*J,A+=n*G,I+=n*K,x+=n*W,O+=n*Y,k+=n*Z,p+=(n=t[9])*B,y+=n*U,m+=n*M,w+=n*L,b+=n*F,v+=n*$,g+=n*z,E+=n*H,_+=n*q,S+=n*V,A+=n*J,I+=n*G,x+=n*K,O+=n*W,k+=n*Y,C+=n*Z,y+=(n=t[10])*B,m+=n*U,w+=n*M,b+=n*L,v+=n*F,g+=n*$,E+=n*z,_+=n*H,S+=n*q,A+=n*V,I+=n*J,x+=n*G,O+=n*K,k+=n*W,C+=n*Y,j+=n*Z,m+=(n=t[11])*B,w+=n*U,b+=n*M,v+=n*L,g+=n*F,E+=n*$,_+=n*z,S+=n*H,A+=n*q,I+=n*V,x+=n*J,O+=n*G,k+=n*K,C+=n*W,j+=n*Y,D+=n*Z,w+=(n=t[12])*B,b+=n*U,v+=n*M,g+=n*L,E+=n*F,_+=n*$,S+=n*z,A+=n*H,I+=n*q,x+=n*V,O+=n*J,k+=n*G,C+=n*K,j+=n*W,D+=n*Y,T+=n*Z,b+=(n=t[13])*B,v+=n*U,g+=n*M,E+=n*L,_+=n*F,S+=n*$,A+=n*z,I+=n*H,x+=n*q,O+=n*V,k+=n*J,C+=n*G,j+=n*K,D+=n*W,T+=n*Y,P+=n*Z,v+=(n=t[14])*B,g+=n*U,E+=n*M,_+=n*L,S+=n*F,A+=n*$,I+=n*z,x+=n*H,O+=n*q,k+=n*V,C+=n*J,j+=n*G,D+=n*K,T+=n*W,P+=n*Y,R+=n*Z,g+=(n=t[15])*B,a+=38*(_+=n*M),s+=38*(S+=n*L),c+=38*(A+=n*F),u+=38*(I+=n*$),l+=38*(x+=n*z),f+=38*(O+=n*H),h+=38*(k+=n*q),d+=38*(C+=n*V),p+=38*(j+=n*J),y+=38*(D+=n*G),m+=38*(T+=n*K),w+=38*(P+=n*W),b+=38*(R+=n*Y),v+=38*(N+=n*Z),i=(n=(i+=38*(E+=n*U))+(o=1)+65535)-65536*(o=Math.floor(n/65536)),a=(n=a+o+65535)-65536*(o=Math.floor(n/65536)),s=(n=s+o+65535)-65536*(o=Math.floor(n/65536)),c=(n=c+o+65535)-65536*(o=Math.floor(n/65536)),u=(n=u+o+65535)-65536*(o=Math.floor(n/65536)),l=(n=l+o+65535)-65536*(o=Math.floor(n/65536)),f=(n=f+o+65535)-65536*(o=Math.floor(n/65536)),h=(n=h+o+65535)-65536*(o=Math.floor(n/65536)),d=(n=d+o+65535)-65536*(o=Math.floor(n/65536)),p=(n=p+o+65535)-65536*(o=Math.floor(n/65536)),y=(n=y+o+65535)-65536*(o=Math.floor(n/65536)),m=(n=m+o+65535)-65536*(o=Math.floor(n/65536)),w=(n=w+o+65535)-65536*(o=Math.floor(n/65536)),b=(n=b+o+65535)-65536*(o=Math.floor(n/65536)),v=(n=v+o+65535)-65536*(o=Math.floor(n/65536)),g=(n=g+o+65535)-65536*(o=Math.floor(n/65536)),i=(n=(i+=o-1+37*(o-1))+(o=1)+65535)-65536*(o=Math.floor(n/65536)),a=(n=a+o+65535)-65536*(o=Math.floor(n/65536)),s=(n=s+o+65535)-65536*(o=Math.floor(n/65536)),c=(n=c+o+65535)-65536*(o=Math.floor(n/65536)),u=(n=u+o+65535)-65536*(o=Math.floor(n/65536)),l=(n=l+o+65535)-65536*(o=Math.floor(n/65536)),f=(n=f+o+65535)-65536*(o=Math.floor(n/65536)),h=(n=h+o+65535)-65536*(o=Math.floor(n/65536)),d=(n=d+o+65535)-65536*(o=Math.floor(n/65536)),p=(n=p+o+65535)-65536*(o=Math.floor(n/65536)),y=(n=y+o+65535)-65536*(o=Math.floor(n/65536)),m=(n=m+o+65535)-65536*(o=Math.floor(n/65536)),w=(n=w+o+65535)-65536*(o=Math.floor(n/65536)),b=(n=b+o+65535)-65536*(o=Math.floor(n/65536)),v=(n=v+o+65535)-65536*(o=Math.floor(n/65536)),g=(n=g+o+65535)-65536*(o=Math.floor(n/65536)),i+=o-1+37*(o-1),e[0]=i,e[1]=a,e[2]=s,e[3]=c,e[4]=u,e[5]=l,e[6]=f,e[7]=h,e[8]=d,e[9]=p,e[10]=y,e[11]=m,e[12]=w,e[13]=b,e[14]=v,e[15]=g}function w(e,t){m(e,t,t)}function b(e,t){var r,o=n();for(r=0;r<16;r++)o[r]=t[r];for(r=253;r>=0;r--)w(o,o),2!==r&&4!==r&&m(o,o,t);for(r=0;r<16;r++)e[r]=o[r]}new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);t.SH=function(e){var t,r,u,l,v,g,E,_,S,A=[n(),n(),n(),n()];if(t=A,r=e,u=n(),l=n(),v=n(),g=n(),E=n(),_=n(),S=n(),c(t[2],i),function(e,t){for(var r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}(t[1],r),w(v,t[1]),m(g,v,a),y(v,v,t[2]),p(g,t[2],g),w(E,g),w(_,E),m(S,_,E),m(u,S,v),m(u,u,g),function(e,t){var r,o=n();for(r=0;r<16;r++)o[r]=t[r];for(r=250;r>=0;r--)w(o,o),1!==r&&m(o,o,t);for(r=0;r<16;r++)e[r]=o[r]}(u,u),m(u,u,v),m(u,u,g),m(u,u,g),m(t[0],u,g),w(l,t[0]),m(l,l,g),h(l,v)&&m(t[0],t[0],s),w(l,t[0]),m(l,l,g),h(l,v)?-1:(d(t[0])===r[31]>>7&&y(t[0],o,t[0]),m(t[3],t[0],t[1]),0))throw new Error("Ed25519: invalid public key");var I=n(),x=n(),O=A[1];p(I,i,O),y(x,i,O),b(x,x),m(I,I,x);var k=new Uint8Array(32);return f(k,I),k}},117:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16&65535)*n+r*(t>>>16&65535)<<16>>>0)|0},t.add=function(e,t){return e+t|0},t.sub=function(e,t){return e-t|0},t.rotl=function(e,t){return e<<t|e>>>32-t},t.rotr=function(e,t){return e<<32-t|e>>>t},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}},416:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8),o=r(99),i=r(309);function a(e,r){return void 0===r&&(r=t.defaultRandomSource),r.randomBytes(e)}t.defaultRandomSource=new n.SystemRandomSource,t.randomBytes=a,t.randomUint32=function(e){void 0===e&&(e=t.defaultRandomSource);var r=a(4,e),n=o.readUint32LE(r);return i.wipe(r),n};var s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(e,r,n){if(void 0===r&&(r=s),void 0===n&&(n=t.defaultRandomSource),r.length<2)throw new Error("randomString charset is too short");if(r.length>256)throw new Error("randomString charset is too long");for(var o="",c=r.length,u=256-256%c;e>0;){for(var l=a(Math.ceil(256*e/u),n),f=0;f<l.length&&e>0;f++){var h=l[f];h<u&&(o+=r.charAt(h%c),e--)}i.wipe(l)}return o}t.randomString=c,t.randomStringForEntropy=function(e,r,n){return void 0===r&&(r=s),void 0===n&&(n=t.defaultRandomSource),c(Math.ceil(e/(Math.log(r.length)/Math.LN2)),r,n)}},455:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.isAvailable=!1,this.isInstantiated=!1;var e="undefined"!=typeof self?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return e.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var t=new Uint8Array(e),r=0;r<t.length;r+=65536)this._crypto.getRandomValues(t.subarray(r,r+Math.min(t.length-r,65536)));return t},e}();t.BrowserRandomSource=r},871:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(309),o=function(){function e(){this.isAvailable=!1,this.isInstantiated=!1;var e=r(883);e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return e.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var r=new Uint8Array(e),o=0;o<r.length;o++)r[o]=t[o];return n.wipe(t),r},e}();t.NodeRandomSource=o},8:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(455),o=r(871),i=function(){function e(){return this.isAvailable=!1,this.name="",this._source=new n.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new o.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}return e.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},e}();t.SystemRandomSource=i},911:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(99),o=r(309);t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function e(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){o.wipe(this._buffer),o.wipe(this._tempHi),o.wipe(this._tempLo),this.reset()},e.prototype.update=function(e,r){if(void 0===r&&(r=e.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var n=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&r>0;)this._buffer[this._bufferLength++]=e[n++],r--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(n=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,e,n,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[n++],r--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,r=this._bufferLength,o=t/536870912|0,i=t<<3,a=t%128<112?128:256;this._buffer[r]=128;for(var c=r+1;c<a-8;c++)this._buffer[c]=0;n.writeUint32BE(o,this._buffer,a-8),n.writeUint32BE(i,this._buffer,a-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,a),this._finished=!0}for(c=0;c<this.digestLength/8;c++)n.writeUint32BE(this._stateHi[c],e,8*c),n.writeUint32BE(this._stateLo[c],e,8*c+4);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._stateHi.set(e.stateHi),this._stateLo.set(e.stateLo),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){o.wipe(e.stateHi),o.wipe(e.stateLo),e.buffer&&o.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();t.SHA512=i;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(e,t,r,o,i,s,c){for(var u,l,f,h,d,p,y,m,w=r[0],b=r[1],v=r[2],g=r[3],E=r[4],_=r[5],S=r[6],A=r[7],I=o[0],x=o[1],O=o[2],k=o[3],C=o[4],j=o[5],D=o[6],T=o[7];c>=128;){for(var P=0;P<16;P++){var R=8*P+s;e[P]=n.readUint32BE(i,R),t[P]=n.readUint32BE(i,R+4)}for(P=0;P<80;P++){var N,B,U=w,M=b,L=v,F=g,$=E,z=_,H=S,q=I,V=x,J=O,G=k,K=C,W=j,Y=D;if(d=65535&(l=T),p=l>>>16,y=65535&(u=A),m=u>>>16,d+=65535&(l=(C>>>14|E<<18)^(C>>>18|E<<14)^(E>>>9|C<<23)),p+=l>>>16,y+=65535&(u=(E>>>14|C<<18)^(E>>>18|C<<14)^(C>>>9|E<<23)),m+=u>>>16,d+=65535&(l=C&j^~C&D),p+=l>>>16,y+=65535&(u=E&_^~E&S),m+=u>>>16,u=a[2*P],d+=65535&(l=a[2*P+1]),p+=l>>>16,y+=65535&u,m+=u>>>16,u=e[P%16],p+=(l=t[P%16])>>>16,y+=65535&u,m+=u>>>16,y+=(p+=(d+=65535&l)>>>16)>>>16,d=65535&(l=h=65535&d|p<<16),p=l>>>16,y=65535&(u=f=65535&y|(m+=y>>>16)<<16),m=u>>>16,d+=65535&(l=(I>>>28|w<<4)^(w>>>2|I<<30)^(w>>>7|I<<25)),p+=l>>>16,y+=65535&(u=(w>>>28|I<<4)^(I>>>2|w<<30)^(I>>>7|w<<25)),m+=u>>>16,p+=(l=I&x^I&O^x&O)>>>16,y+=65535&(u=w&b^w&v^b&v),m+=u>>>16,N=65535&(y+=(p+=(d+=65535&l)>>>16)>>>16)|(m+=y>>>16)<<16,B=65535&d|p<<16,d=65535&(l=G),p=l>>>16,y=65535&(u=F),m=u>>>16,p+=(l=h)>>>16,y+=65535&(u=f),m+=u>>>16,b=U,v=M,g=L,E=F=65535&(y+=(p+=(d+=65535&l)>>>16)>>>16)|(m+=y>>>16)<<16,_=$,S=z,A=H,w=N,x=q,O=V,k=J,C=G=65535&d|p<<16,j=K,D=W,T=Y,I=B,P%16==15)for(R=0;R<16;R++)u=e[R],d=65535&(l=t[R]),p=l>>>16,y=65535&u,m=u>>>16,u=e[(R+9)%16],d+=65535&(l=t[(R+9)%16]),p+=l>>>16,y+=65535&u,m+=u>>>16,f=e[(R+1)%16],d+=65535&(l=((h=t[(R+1)%16])>>>1|f<<31)^(h>>>8|f<<24)^(h>>>7|f<<25)),p+=l>>>16,y+=65535&(u=(f>>>1|h<<31)^(f>>>8|h<<24)^f>>>7),m+=u>>>16,f=e[(R+14)%16],p+=(l=((h=t[(R+14)%16])>>>19|f<<13)^(f>>>29|h<<3)^(h>>>6|f<<26))>>>16,y+=65535&(u=(f>>>19|h<<13)^(h>>>29|f<<3)^f>>>6),m+=u>>>16,m+=(y+=(p+=(d+=65535&l)>>>16)>>>16)>>>16,e[R]=65535&y|m<<16,t[R]=65535&d|p<<16}d=65535&(l=I),p=l>>>16,y=65535&(u=w),m=u>>>16,u=r[0],p+=(l=o[0])>>>16,y+=65535&u,m+=u>>>16,m+=(y+=(p+=(d+=65535&l)>>>16)>>>16)>>>16,r[0]=w=65535&y|m<<16,o[0]=I=65535&d|p<<16,d=65535&(l=x),p=l>>>16,y=65535&(u=b),m=u>>>16,u=r[1],p+=(l=o[1])>>>16,y+=65535&u,m+=u>>>16,m+=(y+=(p+=(d+=65535&l)>>>16)>>>16)>>>16,r[1]=b=65535&y|m<<16,o[1]=x=65535&d|p<<16,d=65535&(l=O),p=l>>>16,y=65535&(u=v),m=u>>>16,u=r[2],p+=(l=o[2])>>>16,y+=65535&u,m+=u>>>16,m+=(y+=(p+=(d+=65535&l)>>>16)>>>16)>>>16,r[2]=v=65535&y|m<<16,o[2]=O=65535&d|p<<16,d=65535&(l=k),p=l>>>16,y=65535&(u=g),m=u>>>16,u=r[3],p+=(l=o[3])>>>16,y+=65535&u,m+=u>>>16,m+=(y+=(p+=(d+=65535&l)>>>16)>>>16)>>>16,r[3]=g=65535&y|m<<16,o[3]=k=65535&d|p<<16,d=65535&(l=C),p=l>>>16,y=65535&(u=E),m=u>>>16,u=r[4],p+=(l=o[4])>>>16,y+=65535&u,m+=u>>>16,m+=(y+=(p+=(d+=65535&l)>>>16)>>>16)>>>16,r[4]=E=65535&y|m<<16,o[4]=C=65535&d|p<<16,d=65535&(l=j),p=l>>>16,y=65535&(u=_),m=u>>>16,u=r[5],p+=(l=o[5])>>>16,y+=65535&u,m+=u>>>16,m+=(y+=(p+=(d+=65535&l)>>>16)>>>16)>>>16,r[5]=_=65535&y|m<<16,o[5]=j=65535&d|p<<16,d=65535&(l=D),p=l>>>16,y=65535&(u=S),m=u>>>16,u=r[6],p+=(l=o[6])>>>16,y+=65535&u,m+=u>>>16,m+=(y+=(p+=(d+=65535&l)>>>16)>>>16)>>>16,r[6]=S=65535&y|m<<16,o[6]=D=65535&d|p<<16,d=65535&(l=T),p=l>>>16,y=65535&(u=A),m=u>>>16,u=r[7],p+=(l=o[7])>>>16,y+=65535&u,m+=u>>>16,m+=(y+=(p+=(d+=65535&l)>>>16)>>>16)>>>16,r[7]=A=65535&y|m<<16,o[7]=T=65535&d|p<<16,s+=128,c-=128}return s}t.hash=function(e){var t=new i;t.update(e);var r=t.digest();return t.clean(),r}},309:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e}},599:e=>{"use strict";const{AbortController:t,AbortSignal:r}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;e.exports=t,e.exports.AbortSignal=r,e.exports.default=t},620:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(925),o=r(308),i=r(970);class a{constructor(e){"string"==typeof e&&(e=a.parse(e)),this.chainId=new n.ChainId(e.chainId),this.address=e.address}static parse(e){if(!i.isValidId(e,this.spec))throw new Error(`Invalid ${this.spec.name} provided: ${e}`);const{namespace:t,reference:r,address:o}=i.getParams(e,this.spec),s=new n.ChainId({namespace:t,reference:r});return new a({chainId:s,address:o}).toJson()}static format(e){const t=new n.ChainId(e.chainId),r=Object.assign(Object.assign({},t.toJson()),{address:e.address});return i.joinParams(r,this.spec)}toString(){return a.format(this.toJson())}toJson(){return{chainId:this.chainId.toJson(),address:this.address}}}t.AccountId=a,a.spec=o.CAIP[10]},341:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(350),o=r(925),i=r(308),a=r(970);class s{constructor(e){"string"==typeof e&&(e=s.parse(e)),this.chainId=new o.ChainId(e.chainId),this.assetName=new n.AssetName(e.assetName),this.tokenId=e.tokenId}static parse(e){if(!a.isValidId(e,this.spec))throw new Error(`Invalid ${this.spec.name} provided: ${e}`);return new s(a.getParams(e,this.spec)).toJson()}static format(e){return a.joinParams(e,this.spec)}toString(){return s.format(this.toJson())}toJson(){return{chainId:this.chainId.toJson(),assetName:this.assetName.toJson(),tokenId:this.tokenId}}}t.AssetId=s,s.spec=i.CAIP[19].assetId},350:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(308),o=r(970);class i{constructor(e){"string"==typeof e&&(e=i.parse(e)),this.namespace=e.namespace,this.reference=e.reference}static parse(e){if(!o.isValidId(e,this.spec))throw new Error(`Invalid ${this.spec.name} provided: ${e}`);return new i(o.getParams(e,this.spec)).toJson()}static format(e){return o.joinParams(e,this.spec)}toString(){return i.format(this.toJson())}toJson(){return{namespace:this.namespace,reference:this.reference}}}t.AssetName=i,i.spec=n.CAIP[19].assetName},428:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(350),o=r(925),i=r(308),a=r(970);class s{constructor(e){"string"==typeof e&&(e=s.parse(e)),this.chainId=new o.ChainId(e.chainId),this.assetName=new n.AssetName(e.assetName)}static parse(e){if(!a.isValidId(e,this.spec))throw new Error(`Invalid ${this.spec.name} provided: ${e}`);return new s(a.getParams(e,this.spec)).toJson()}static format(e){return a.joinParams(e,this.spec)}toString(){return s.format(this.toJson())}toJson(){return{chainId:this.chainId.toJson(),assetName:this.assetName}}}t.AssetType=s,s.spec=i.CAIP[19].assetType},925:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(308),o=r(970);class i{constructor(e){"string"==typeof e&&(e=i.parse(e)),this.namespace=e.namespace,this.reference=e.reference}static parse(e){if(!o.isValidId(e,this.spec))throw new Error(`Invalid ${this.spec.name} provided: ${e}`);return new i(o.getParams(e,this.spec)).toJson()}static format(e){return o.joinParams(e,this.spec)}toString(){return i.format(this.toJson())}toJson(){return{namespace:this.namespace,reference:this.reference}}}t.ChainId=i,i.spec=n.CAIP[2]},872:(e,t,r)=>{"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(620)),n(r(925)),n(r(428)),n(r(341))},308:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={name:"chainId",regex:"[-:a-zA-Z0-9]{5,41}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,32}"}}}},n={name:"assetName",regex:"[-:a-zA-Z0-9]{5,73}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,64}"}}}},o={name:"assetType",regex:"[-:a-zA-Z0-9]{11,115}",parameters:{delimiter:"/",values:{0:r,1:n}}},i={name:"assetId",regex:"[-:a-zA-Z0-9]{13,148}",parameters:{delimiter:"/",values:{0:r,1:n,2:{name:"tokenId",regex:"[-a-zA-Z0-9]{1,32}"}}}};t.CAIP={2:r,10:{name:"accountId",regex:"[-:a-zA-Z0-9]{7,106}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,32}"},2:{name:"address",regex:"[a-zA-Z0-9]{1,64}"}}}},19:{assetName:n,assetType:o,assetId:i}}},970:(e,t)=>{"use strict";function r(e,t){return e.split(t.parameters.delimiter)}Object.defineProperty(t,"__esModule",{value:!0}),t.splitParams=r,t.getParams=function(e,t){const n=r(e,t),o={};return n.forEach(((e,r)=>{o[t.parameters.values[r].name]=e})),o},t.joinParams=function e(t,r){return Object.values(r.parameters.values).map((r=>{const n=t[r.name];return"string"==typeof n?n:e(n,r)})).join(r.parameters.delimiter)},t.isValidId=function(e,t){if(!new RegExp(t.regex).test(e))return!1;const n=r(e,t);return n.length===Object.keys(t.parameters.values).length&&n.map(((e,r)=>new RegExp(t.parameters.values[r].regex).test(e))).filter((e=>!!e)).length===n.length}},98:function(e,t){var r="undefined"!=typeof self?self:this,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,a="ArrayBuffer"in e;if(a)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function d(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function y(e){var t=new FileReader,r=p(t);return t.readAsArrayBuffer(e),r}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():a&&o&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e,t,r,n=d(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,r=p(t=new FileReader),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=u(e),t=l(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},h.prototype.delete=function(e){delete this.map[u(e)]},h.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},h.prototype.set=function(e,t){this.map[u(e)]=l(t)},h.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},h.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),f(e)},h.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},h.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),f(e)},n&&(h.prototype[Symbol.iterator]=h.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(e,t){var r,n,o=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=(n=(r=t.method||this.method||"GET").toUpperCase(),b.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function g(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(o))}})),t}function E(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},w.call(v.prototype),w.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},E.error=function(){var e=new E(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];E.redirect=function(e,t){if(-1===_.indexOf(t))throw new RangeError("Invalid status code");return new E(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function S(e,r){return new Promise((function(n,i){var a=new v(e,r);if(a.signal&&a.signal.aborted)return i(new t.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function c(){s.abort()}s.onload=function(){var e,t,r={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new h,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();t.append(n,o)}})),t)};r.url="responseURL"in s?s.responseURL:r.headers.get("X-Request-URL");var o="response"in s?s.response:s.responseText;n(new E(o,r))},s.onerror=function(){i(new TypeError("Network request failed"))},s.ontimeout=function(){i(new TypeError("Network request failed"))},s.onabort=function(){i(new t.DOMException("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&o&&(s.responseType="blob"),a.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),a.signal&&(a.signal.addEventListener("abort",c),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",c)}),s.send(void 0===a._bodyInit?null:a._bodyInit)}))}S.polyfill=!0,e.fetch||(e.fetch=S,e.Headers=h,e.Request=v,e.Response=E),t.Headers=h,t.Request=v,t.Response=E,t.fetch=S,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;(t=o.fetch).default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,e.exports=t},933:e=>{"use strict";var t,r=function(){function e(e,t){if("function"!=typeof e)throw new TypeError("DataLoader must be constructed with a function which accepts Array<key> and returns Promise<Array<value>>, but got: "+e+".");this._batchLoadFn=e,this._maxBatchSize=function(e){if(e&&!1===e.batch)return 1;var t=e&&e.maxBatchSize;if(void 0===t)return 1/0;if("number"!=typeof t||t<1)throw new TypeError("maxBatchSize must be a positive number: "+t);return t}(t),this._batchScheduleFn=function(e){var t=e&&e.batchScheduleFn;if(void 0===t)return n;if("function"!=typeof t)throw new TypeError("batchScheduleFn must be a function: "+t);return t}(t),this._cacheKeyFn=function(e){var t=e&&e.cacheKeyFn;if(void 0===t)return function(e){return e};if("function"!=typeof t)throw new TypeError("cacheKeyFn must be a function: "+t);return t}(t),this._cacheMap=function(e){if(e&&!1===e.cache)return null;var t=e&&e.cacheMap;if(void 0===t)return new Map;if(null!==t){var r=["get","set","delete","clear"].filter((function(e){return t&&"function"!=typeof t[e]}));if(0!==r.length)throw new TypeError("Custom cacheMap missing methods: "+r.join(", "))}return t}(t),this._batch=null}var t=e.prototype;return t.load=function(e){if(null==e)throw new TypeError("The loader.load() function must be called with a value, but got: "+String(e)+".");var t=function(e){var t=e._batch;if(null!==t&&!t.hasDispatched&&t.keys.length<e._maxBatchSize&&(!t.cacheHits||t.cacheHits.length<e._maxBatchSize))return t;var r={hasDispatched:!1,keys:[],callbacks:[]};return e._batch=r,e._batchScheduleFn((function(){!function(e,t){if(t.hasDispatched=!0,0!==t.keys.length){var r=e._batchLoadFn(t.keys);if(!r||"function"!=typeof r.then)return o(e,t,new TypeError("DataLoader must be constructed with a function which accepts Array<key> and returns Promise<Array<value>>, but the function did not return a Promise: "+String(r)+"."));r.then((function(e){if(!a(e))throw new TypeError("DataLoader must be constructed with a function which accepts Array<key> and returns Promise<Array<value>>, but the function did not return a Promise of an Array: "+String(e)+".");if(e.length!==t.keys.length)throw new TypeError("DataLoader must be constructed with a function which accepts Array<key> and returns Promise<Array<value>>, but the function did not return a Promise of an Array of the same length as the Array of keys.\n\nKeys:\n"+String(t.keys)+"\n\nValues:\n"+String(e));i(t);for(var r=0;r<t.callbacks.length;r++){var n=e[r];n instanceof Error?t.callbacks[r].reject(n):t.callbacks[r].resolve(n)}})).catch((function(r){o(e,t,r)}))}else i(t)}(e,r)})),r}(this),r=this._cacheMap,n=this._cacheKeyFn(e);if(r){var s=r.get(n);if(s){var c=t.cacheHits||(t.cacheHits=[]);return new Promise((function(e){c.push((function(){e(s)}))}))}}t.keys.push(e);var u=new Promise((function(e,r){t.callbacks.push({resolve:e,reject:r})}));return r&&r.set(n,u),u},t.loadMany=function(e){if(!a(e))throw new TypeError("The loader.loadMany() function must be called with Array<key> but got: "+e+".");for(var t=[],r=0;r<e.length;r++)t.push(this.load(e[r]).catch((function(e){return e})));return Promise.all(t)},t.clear=function(e){var t=this._cacheMap;if(t){var r=this._cacheKeyFn(e);t.delete(r)}return this},t.clearAll=function(){var e=this._cacheMap;return e&&e.clear(),this},t.prime=function(e,t){var r=this._cacheMap;if(r){var n,o=this._cacheKeyFn(e);void 0===r.get(o)&&(t instanceof Error?(n=Promise.reject(t)).catch((function(){})):n=Promise.resolve(t),r.set(o,n))}return this},e}(),n="object"==typeof process&&"function"==typeof process.nextTick?function(e){t||(t=Promise.resolve()),t.then((function(){process.nextTick(e)}))}:"function"==typeof setImmediate?function(e){setImmediate(e)}:function(e){setTimeout(e)};function o(e,t,r){i(t);for(var n=0;n<t.keys.length;n++)e.clear(t.keys[n]),t.callbacks[n].reject(r)}function i(e){if(e.cacheHits)for(var t=0;t<e.cacheHits.length;t++)e.cacheHits[t]()}function a(e){return"object"==typeof e&&null!==e&&"number"==typeof e.length&&(0===e.length||e.length>0&&Object.prototype.hasOwnProperty.call(e,e.length-1))}e.exports=r},20:e=>{"use strict";var t="%[a-f0-9]{2}",r=new RegExp(t,"gi"),n=new RegExp("("+t+")+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],o(r),o(n))}function i(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(r),n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(r);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=n.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var o=i(r[0]);o!==r[0]&&(t[r[0]]=o)}r=n.exec(e)}t["%C2"]="�";for(var a=Object.keys(t),s=0;s<a.length;s++){var c=a[s];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},806:e=>{"use strict";e.exports=function(e,t){for(var r={},n=Object.keys(e),o=Array.isArray(t),i=0;i<n.length;i++){var a=n[i],s=e[a];(o?-1!==t.indexOf(a):t(a,s,e))&&(r[a]=s)}return r}},465:(e,t,r)=>{e=r.nmd(e);var n="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",a="[object Boolean]",s="[object Date]",c="[object Function]",u="[object GeneratorFunction]",l="[object Map]",f="[object Number]",h="[object Object]",d="[object Promise]",p="[object RegExp]",y="[object Set]",m="[object String]",w="[object Symbol]",b="[object WeakMap]",v="[object ArrayBuffer]",g="[object DataView]",E="[object Float32Array]",_="[object Float64Array]",S="[object Int8Array]",A="[object Int16Array]",I="[object Int32Array]",x="[object Uint8Array]",O="[object Uint8ClampedArray]",k="[object Uint16Array]",C="[object Uint32Array]",j=/\w*$/,D=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,P={};P[i]=P["[object Array]"]=P[v]=P[g]=P[a]=P[s]=P[E]=P[_]=P[S]=P[A]=P[I]=P[l]=P[f]=P[h]=P[p]=P[y]=P[m]=P[w]=P[x]=P[O]=P[k]=P[C]=!0,P["[object Error]"]=P[c]=P[b]=!1;var R="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,N="object"==typeof self&&self&&self.Object===Object&&self,B=R||N||Function("return this")(),U=t&&!t.nodeType&&t,M=U&&e&&!e.nodeType&&e,L=M&&M.exports===U;function F(e,t){return e.set(t[0],t[1]),e}function $(e,t){return e.add(t),e}function z(e,t,r,n){var o=-1,i=e?e.length:0;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}function H(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function q(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function V(e,t){return function(r){return e(t(r))}}function J(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var G,K=Array.prototype,W=Function.prototype,Y=Object.prototype,Z=B["__core-js_shared__"],X=(G=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"",Q=W.toString,ee=Y.hasOwnProperty,te=Y.toString,re=RegExp("^"+Q.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=L?B.Buffer:void 0,oe=B.Symbol,ie=B.Uint8Array,ae=V(Object.getPrototypeOf,Object),se=Object.create,ce=Y.propertyIsEnumerable,ue=K.splice,le=Object.getOwnPropertySymbols,fe=ne?ne.isBuffer:void 0,he=V(Object.keys,Object),de=Be(B,"DataView"),pe=Be(B,"Map"),ye=Be(B,"Promise"),me=Be(B,"Set"),we=Be(B,"WeakMap"),be=Be(Object,"create"),ve=$e(de),ge=$e(pe),Ee=$e(ye),_e=$e(me),Se=$e(we),Ae=oe?oe.prototype:void 0,Ie=Ae?Ae.valueOf:void 0;function xe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Oe(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ke(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Ce(e){this.__data__=new Oe(e)}function je(e,t,r){var n=e[t];ee.call(e,t)&&ze(n,r)&&(void 0!==r||t in e)||(e[t]=r)}function De(e,t){for(var r=e.length;r--;)if(ze(e[r][0],t))return r;return-1}function Te(e,t,r,n,o,d,b){var D;if(n&&(D=d?n(e,o,d,b):n(e)),void 0!==D)return D;if(!Ge(e))return e;var T=He(e);if(T){if(D=function(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&ee.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!t)return function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(e,D)}else{var R=Me(e),N=R==c||R==u;if(Ve(e))return function(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}(e,t);if(R==h||R==i||N&&!d){if(H(e))return d?e:{};if(D=function(e){return"function"!=typeof e.constructor||Fe(e)?{}:Ge(t=ae(e))?se(t):{};var t}(N?{}:e),!t)return function(e,t){return Re(e,Ue(e),t)}(e,function(e,t){return e&&Re(t,Ke(t),e)}(D,e))}else{if(!P[R])return d?e:{};D=function(e,t,r,n){var o,i=e.constructor;switch(t){case v:return Pe(e);case a:case s:return new i(+e);case g:return function(e,t){var r=t?Pe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,n);case E:case _:case S:case A:case I:case x:case O:case k:case C:return function(e,t){var r=t?Pe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,n);case l:return function(e,t,r){return z(t?r(q(e),!0):q(e),F,new e.constructor)}(e,n,r);case f:case m:return new i(e);case p:return function(e){var t=new e.constructor(e.source,j.exec(e));return t.lastIndex=e.lastIndex,t}(e);case y:return function(e,t,r){return z(t?r(J(e),!0):J(e),$,new e.constructor)}(e,n,r);case w:return o=e,Ie?Object(Ie.call(o)):{}}}(e,R,Te,t)}}b||(b=new Ce);var B=b.get(e);if(B)return B;if(b.set(e,D),!T)var U=r?function(e){return function(e,t,r){var n=t(e);return He(e)?n:function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}(n,r(e))}(e,Ke,Ue)}(e):Ke(e);return function(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r););}(U||e,(function(o,i){U&&(o=e[i=o]),je(D,i,Te(o,t,r,n,i,e,b))})),D}function Pe(e){var t=new e.constructor(e.byteLength);return new ie(t).set(new ie(e)),t}function Re(e,t,r,n){r||(r={});for(var o=-1,i=t.length;++o<i;){var a=t[o],s=n?n(r[a],e[a],a,r,e):void 0;je(r,a,void 0===s?e[a]:s)}return r}function Ne(e,t){var r,n,o=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof t?"string":"hash"]:o.map}function Be(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Ge(e)||(t=e,X&&X in t))&&(Je(e)||H(e)?re:D).test($e(e));var t}(r)?r:void 0}xe.prototype.clear=function(){this.__data__=be?be(null):{}},xe.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},xe.prototype.get=function(e){var t=this.__data__;if(be){var r=t[e];return r===n?void 0:r}return ee.call(t,e)?t[e]:void 0},xe.prototype.has=function(e){var t=this.__data__;return be?void 0!==t[e]:ee.call(t,e)},xe.prototype.set=function(e,t){return this.__data__[e]=be&&void 0===t?n:t,this},Oe.prototype.clear=function(){this.__data__=[]},Oe.prototype.delete=function(e){var t=this.__data__,r=De(t,e);return!(r<0||(r==t.length-1?t.pop():ue.call(t,r,1),0))},Oe.prototype.get=function(e){var t=this.__data__,r=De(t,e);return r<0?void 0:t[r][1]},Oe.prototype.has=function(e){return De(this.__data__,e)>-1},Oe.prototype.set=function(e,t){var r=this.__data__,n=De(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},ke.prototype.clear=function(){this.__data__={hash:new xe,map:new(pe||Oe),string:new xe}},ke.prototype.delete=function(e){return Ne(this,e).delete(e)},ke.prototype.get=function(e){return Ne(this,e).get(e)},ke.prototype.has=function(e){return Ne(this,e).has(e)},ke.prototype.set=function(e,t){return Ne(this,e).set(e,t),this},Ce.prototype.clear=function(){this.__data__=new Oe},Ce.prototype.delete=function(e){return this.__data__.delete(e)},Ce.prototype.get=function(e){return this.__data__.get(e)},Ce.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Oe){var n=r.__data__;if(!pe||n.length<199)return n.push([e,t]),this;r=this.__data__=new ke(n)}return r.set(e,t),this};var Ue=le?V(le,Object):function(){return[]},Me=function(e){return te.call(e)};function Le(e,t){return!!(t=null==t?o:t)&&("number"==typeof e||T.test(e))&&e>-1&&e%1==0&&e<t}function Fe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Y)}function $e(e){if(null!=e){try{return Q.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function ze(e,t){return e===t||e!=e&&t!=t}(de&&Me(new de(new ArrayBuffer(1)))!=g||pe&&Me(new pe)!=l||ye&&Me(ye.resolve())!=d||me&&Me(new me)!=y||we&&Me(new we)!=b)&&(Me=function(e){var t=te.call(e),r=t==h?e.constructor:void 0,n=r?$e(r):void 0;if(n)switch(n){case ve:return g;case ge:return l;case Ee:return d;case _e:return y;case Se:return b}return t});var He=Array.isArray;function qe(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}(e.length)&&!Je(e)}var Ve=fe||function(){return!1};function Je(e){var t=Ge(e)?te.call(e):"";return t==c||t==u}function Ge(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Ke(e){return qe(e)?function(e,t){var r=He(e)||function(e){return function(e){return function(e){return!!e&&"object"==typeof e}(e)&&qe(e)}(e)&&ee.call(e,"callee")&&(!ce.call(e,"callee")||te.call(e)==i)}(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,o=!!n;for(var a in e)!t&&!ee.call(e,a)||o&&("length"==a||Le(a,n))||r.push(a);return r}(e):function(e){if(!Fe(e))return he(e);var t=[];for(var r in Object(e))ee.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}e.exports=function(e){return Te(e,!0,!0)}},230:function(e,t){!function(e){const t=Symbol("newer"),r=Symbol("older");class n{constructor(e,t){"number"!=typeof e&&(t=e,e=0),this.size=0,this.limit=e,this.oldest=this.newest=void 0,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[t]&&(e===this.oldest&&(this.oldest=e[t]),e[t][r]=e[r]),e[r]&&(e[r][t]=e[t]),e[t]=void 0,e[r]=this.newest,this.newest&&(this.newest[t]=e),this.newest=e)}assign(e){let n,i=this.limit||Number.MAX_VALUE;this._keymap.clear();let a=e[Symbol.iterator]();for(let e=a.next();!e.done;e=a.next()){let a=new o(e.value[0],e.value[1]);if(this._keymap.set(a.key,a),n?(n[t]=a,a[r]=n):this.oldest=a,n=a,0==i--)throw new Error("overflow")}this.newest=n,this.size=this._keymap.size}get(e){var t=this._keymap.get(e);return t?(this._markEntryAsUsed(t),t.value):void 0}set(e,n){var i=this._keymap.get(e);return i?(i.value=n,this._markEntryAsUsed(i),this):(this._keymap.set(e,i=new o(e,n)),this.newest?(this.newest[t]=i,i[r]=this.newest):this.oldest=i,this.newest=i,++this.size,this.size>this.limit&&this.shift(),this)}shift(){var e=this.oldest;if(e)return this.oldest[t]?(this.oldest=this.oldest[t],this.oldest[r]=void 0):(this.oldest=void 0,this.newest=void 0),e[t]=e[r]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]}find(e){let t=this._keymap.get(e);return t?t.value:void 0}has(e){return this._keymap.has(e)}delete(e){var n=this._keymap.get(e);return n?(this._keymap.delete(n.key),n[t]&&n[r]?(n[r][t]=n[t],n[t][r]=n[r]):n[t]?(n[t][r]=void 0,this.oldest=n[t]):n[r]?(n[r][t]=void 0,this.newest=n[r]):this.oldest=this.newest=void 0,this.size--,n.value):void 0}clear(){this.oldest=this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new a(this.oldest)}values(){return new s(this.oldest)}entries(){return this}[Symbol.iterator](){return new i(this.oldest)}forEach(e,r){"object"!=typeof r&&(r=this);let n=this.oldest;for(;n;)e.call(r,n.value,n.key,this),n=n[t]}toJSON(){for(var e=new Array(this.size),r=0,n=this.oldest;n;)e[r++]={key:n.key,value:n.value},n=n[t];return e}toString(){for(var e="",r=this.oldest;r;)e+=String(r.key)+":"+r.value,(r=r[t])&&(e+=" < ");return e}}function o(e,n){this.key=e,this.value=n,this[t]=void 0,this[r]=void 0}function i(e){this.entry=e}function a(e){this.entry=e}function s(e){this.entry=e}e.LRUMap=n,i.prototype[Symbol.iterator]=function(){return this},i.prototype.next=function(){let e=this.entry;return e?(this.entry=e[t],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}},a.prototype[Symbol.iterator]=function(){return this},a.prototype.next=function(){let e=this.entry;return e?(this.entry=e[t],{done:!1,value:e.key}):{done:!0,value:void 0}},s.prototype[Symbol.iterator]=function(){return this},s.prototype.next=function(){let e=this.entry;return e?(this.entry=e[t],{done:!1,value:e.value}):{done:!0,value:void 0}}}(t)},563:(e,t,r)=>{"use strict";const n=r(610),o=r(20),i=r(500),a=r(806),s=Symbol("encodeFragmentIdentifier");function c(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function u(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function l(e,t){return t.decode?o(e):e}function f(e){return Array.isArray(e)?e.sort():"object"==typeof e?f(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function h(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){const t=(e=h(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function y(e,t){c((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"colon-list-separator":return(e,r,n)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const o="string"==typeof r&&r.includes(e.arrayFormatSeparator),i="string"==typeof r&&!o&&l(r,e).includes(e.arrayFormatSeparator);r=i?l(r,e):r;const a=o||i?r.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===r?r:l(r,e);n[t]=a};case"bracket-separator":return(t,r,n)=>{const o=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!o)return void(n[t]=r?l(r,e):r);const i=null===r?[]:r.split(e.arrayFormatSeparator).map((t=>l(t,e)));void 0!==n[t]?n[t]=[].concat(n[t],i):n[t]=i};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const o of e.split("&")){if(""===o)continue;let[e,a]=i(t.decode?o.replace(/\+/g," "):o,"=");a=void 0===a?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?a:l(a,t),r(l(e,t),a,n)}for(const e of Object.keys(n)){const r=n[e];if("object"==typeof r&&null!==r)for(const e of Object.keys(r))r[e]=p(r[e],t);else n[e]=p(r,t)}return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce(((e,t)=>{const r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=f(r):e[t]=r,e}),Object.create(null))}t.extract=d,t.parse=y,t.stringify=(e,t)=>{if(!e)return"";c((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const o=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[u(t,e),"[",o,"]"].join("")]:[...r,[u(t,e),"[",u(o,e),"]=",u(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[u(t,e),"[]"].join("")]:[...r,[u(t,e),"[]=",u(n,e)].join("")];case"colon-list-separator":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[u(t,e),":list="].join("")]:[...r,[u(t,e),":list=",u(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(n,o)=>void 0===o||e.skipNull&&null===o||e.skipEmptyString&&""===o?n:(o=null===o?"":o,0===n.length?[[u(r,e),t,u(o,e)].join("")]:[[n,u(o,e)].join(e.arrayFormatSeparator)])}default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,u(t,e)]:[...r,[u(t,e),"=",u(n,e)].join("")]}}(t),o={};for(const t of Object.keys(e))r(t)||(o[t]=e[t]);const i=Object.keys(o);return!1!==t.sort&&i.sort(t.sort),i.map((r=>{const o=e[r];return void 0===o?"":null===o?u(r,t):Array.isArray(o)?0===o.length&&"bracket-separator"===t.arrayFormat?u(r,t)+"[]":o.reduce(n(r),[]).join("&"):u(r,t)+"="+u(o,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,n]=i(e,"#");return Object.assign({url:r.split("?")[0]||"",query:y(d(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:l(n,t)}:{})},t.stringifyUrl=(e,r)=>{r=Object.assign({encode:!0,strict:!0,[s]:!0},r);const n=h(e.url).split("?")[0]||"",o=t.extract(e.url),i=t.parse(o,{sort:!1}),a=Object.assign(i,e.query);let c=t.stringify(a,r);c&&(c=`?${c}`);let l=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);return e.fragmentIdentifier&&(l=`#${r[s]?u(e.fragmentIdentifier,r):e.fragmentIdentifier}`),`${n}${c}${l}`},t.pick=(e,r,n)=>{n=Object.assign({parseFragmentIdentifier:!0,[s]:!1},n);const{url:o,query:i,fragmentIdentifier:c}=t.parseUrl(e,n);return t.stringifyUrl({url:o,query:a(i,r),fragmentIdentifier:c},n)},t.exclude=(e,r,n)=>{const o=Array.isArray(r)?e=>!r.includes(e):(e,t)=>!r(e,t);return t.pick(e,o,n)}},500:e=>{"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]}},610:e=>{"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},988:e=>{e.exports=function e(t,r){var n,o=0,i=0,a=r=r||0,s=t.length;do{if(a>=s||i>49)throw e.bytes=0,new RangeError("Could not decode varint");n=t[a++],o+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=a-r,o}},312:e=>{e.exports=function e(r,n,o){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw e.bytes=0,new RangeError("Could not encode varint");n=n||[];for(var i=o=o||0;r>=t;)n[o++]=255&r|128,r/=128;for(;-128&r;)n[o++]=255&r|128,r>>>=7;return n[o]=0|r,e.bytes=o-i+1,n};var t=Math.pow(2,31)},676:(e,t,r)=>{e.exports={encode:r(312),decode:r(988),encodingLength:r(82)}},82:e=>{var t=Math.pow(2,7),r=Math.pow(2,14),n=Math.pow(2,21),o=Math.pow(2,28),i=Math.pow(2,35),a=Math.pow(2,42),s=Math.pow(2,49),c=Math.pow(2,56),u=Math.pow(2,63);e.exports=function(e){return e<t?1:e<r?2:e<n?3:e<o?4:e<i?5:e<a?6:e<s?7:e<c?8:e<u?9:10}},883:()=>{}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var n={};return(()=>{"use strict";r.d(n,{default:()=>ac});var e={};r.r(e),r.d(e,{JsonPatchError:()=>R,_areEquals:()=>q,applyOperation:()=>L,applyPatch:()=>F,applyReducer:()=>$,deepClone:()=>N,getValueByPointer:()=>M,validate:()=>H,validator:()=>z});var t={};r.r(t),r.d(t,{compare:()=>X,generate:()=>Y,observe:()=>W,unobserve:()=>K});var o={};r.r(o),r.d(o,{base58btc:()=>Gt,base58flickr:()=>Kt});var i={};r.r(i),r.d(i,{base32:()=>Wt,base32hex:()=>Qt,base32hexpad:()=>tr,base32hexpadupper:()=>rr,base32hexupper:()=>er,base32pad:()=>Zt,base32padupper:()=>Xt,base32upper:()=>Yt,base32z:()=>nr});var a={};r.r(a),r.d(a,{code:()=>vr,decode:()=>Er,encode:()=>gr,name:()=>br});var s={};r.r(s),r.d(s,{identity:()=>Sr});var c={};r.r(c),r.d(c,{base2:()=>Ar});var u={};r.r(u),r.d(u,{base8:()=>Ir});var l={};r.r(l),r.d(l,{base10:()=>xr});var f={};r.r(f),r.d(f,{base16:()=>Or,base16upper:()=>kr});var h={};r.r(h),r.d(h,{base36:()=>Cr,base36upper:()=>jr});var d={};r.r(d),r.d(d,{base64:()=>Dr,base64pad:()=>Tr,base64url:()=>Pr,base64urlpad:()=>Rr});var p={};r.r(p),r.d(p,{sha256:()=>Mr,sha512:()=>Lr});var y={};r.r(y),r.d(y,{identity:()=>$r});var m={};r.r(m),r.d(m,{code:()=>Hr,decode:()=>Vr,encode:()=>qr,name:()=>zr});var w={};r.r(w),r.d(w,{code:()=>Wr,decode:()=>Zr,encode:()=>Yr,name:()=>Kr});var b={};r.r(b),r.d(b,{keyToDidDoc:()=>bs});var v={};r.r(v),r.d(v,{keyToDidDoc:()=>gs});var g={};r.r(g),r.d(g,{ECPointDecompress:()=>Cs,keyToDidDoc:()=>ks,pubKeyBytesToXY:()=>js});var E={};r.r(E),r.d(E,{ECPointDecompress:()=>Ts,keyToDidDoc:()=>Ds,pubKeyBytesToXY:()=>Ps});var _={};r.r(_),r.d(_,{ECPointDecompress:()=>Ns,keyToDidDoc:()=>Rs,pubKeyBytesToXY:()=>Bs});var S=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),A=Object.prototype.hasOwnProperty;function I(e,t){return A.call(e,t)}function x(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);var n=[];for(var o in e)I(e,o)&&n.push(o);return n}function O(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function k(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++}return!0}function C(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function j(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function D(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,r=e.length;t<r;t++)if(D(e[t]))return!0}else if("object"==typeof e)for(var n=x(e),o=n.length,i=0;i<o;i++)if(D(e[n[i]]))return!0;return!1}function T(e,t){var r=[e];for(var n in t){var o="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==o&&r.push(n+": "+o)}return r.join("\n")}var P=function(e){function t(t,r,n,o,i){var a=this.constructor,s=e.call(this,T(t,{name:r,index:n,operation:o,tree:i}))||this;return s.name=r,s.index=n,s.operation=o,s.tree=i,Object.setPrototypeOf(s,a.prototype),s.message=T(t,{name:r,index:n,operation:o,tree:i}),s}return S(t,e),t}(Error),R=P,N=O,B={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var n=M(r,this.path);n&&(n=O(n));var o=L(r,{op:"remove",path:this.from}).removed;return L(r,{op:"add",path:this.path,value:o}),{newDocument:r,removed:n}},copy:function(e,t,r){var n=M(r,this.from);return L(r,{op:"add",path:this.path,value:O(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:q(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},U={add:function(e,t,r){return k(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:B.move,copy:B.copy,test:B.test,_get:B._get};function M(e,t){if(""==t)return e;var r={op:"_get",path:t};return L(e,r),r.value}function L(e,t,r,n,o,i){if(void 0===r&&(r=!1),void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===i&&(i=0),r&&("function"==typeof r?r(t,0,e,t.path):z(t,0)),""===t.path){var a={newDocument:e};if("add"===t.op)return a.newDocument=t.value,a;if("replace"===t.op)return a.newDocument=t.value,a.removed=e,a;if("move"===t.op||"copy"===t.op)return a.newDocument=M(e,t.from),"move"===t.op&&(a.removed=e),a;if("test"===t.op){if(a.test=q(e,t.value),!1===a.test)throw new R("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return a.newDocument=e,a}if("remove"===t.op)return a.removed=e,a.newDocument=null,a;if("_get"===t.op)return t.value=e,a;if(r)throw new R("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return a}n||(e=O(e));var s=(t.path||"").split("/"),c=e,u=1,l=s.length,f=void 0,h=void 0,d=void 0;for(d="function"==typeof r?r:z;;){if((h=s[u])&&-1!=h.indexOf("~")&&(h=j(h)),o&&("__proto__"==h||"prototype"==h&&u>0&&"constructor"==s[u-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&void 0===f&&(void 0===c[h]?f=s.slice(0,u).join("/"):u==l-1&&(f=t.path),void 0!==f&&d(t,0,e,f)),u++,Array.isArray(c)){if("-"===h)h=c.length;else{if(r&&!k(h))throw new R("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);k(h)&&(h=~~h)}if(u>=l){if(r&&"add"===t.op&&h>c.length)throw new R("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);if(!1===(a=U[t.op].call(t,c,h,e)).test)throw new R("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return a}}else if(u>=l){if(!1===(a=B[t.op].call(t,c,h,e)).test)throw new R("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return a}if(c=c[h],r&&u<l&&(!c||"object"!=typeof c))throw new R("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,t,e)}}function F(e,t,r,n,o){if(void 0===n&&(n=!0),void 0===o&&(o=!0),r&&!Array.isArray(t))throw new R("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(e=O(e));for(var i=new Array(t.length),a=0,s=t.length;a<s;a++)i[a]=L(e,t[a],r,!0,o,a),e=i[a].newDocument;return i.newDocument=e,i}function $(e,t,r){var n=L(e,t);if(!1===n.test)throw new R("Test operation failed","TEST_OPERATION_FAILED",r,t,e);return n.newDocument}function z(e,t,r,n){if("object"!=typeof e||null===e||Array.isArray(e))throw new R("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,r);if(!B[e.op])throw new R("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,r);if("string"!=typeof e.path)throw new R("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,r);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new R('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,r);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new R("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new R("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&D(e.value))throw new R("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,r);if(r)if("add"==e.op){var o=e.path.split("/").length,i=n.split("/").length;if(o!==i+1&&o!==i)throw new R("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,r)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==n)throw new R("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,r)}else if("move"===e.op||"copy"===e.op){var a=H([{op:"_get",path:e.from,value:void 0}],r);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new R("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,r)}}function H(e,t,r){try{if(!Array.isArray(e))throw new R("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)F(O(t),O(e),r||!0);else{r=r||z;for(var n=0;n<e.length;n++)r(e[n],n,t,void 0)}}catch(e){if(e instanceof R)return e;throw e}}function q(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,n,o,i=Array.isArray(e),a=Array.isArray(t);if(i&&a){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!q(e[r],t[r]))return!1;return!0}if(i!=a)return!1;var s=Object.keys(e);if((n=s.length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!t.hasOwnProperty(s[r]))return!1;for(r=n;0!=r--;)if(!q(e[o=s[r]],t[o]))return!1;return!0}return e!=e&&t!=t}var V=new WeakMap,J=function(e){this.observers=new Map,this.obj=e},G=function(e,t){this.callback=e,this.observer=t};function K(e,t){t.unobserve()}function W(e,t){var r,n=function(e){return V.get(e)}(e);if(n){var o=function(e,t){return e.observers.get(t)}(n,t);r=o&&o.observer}else n=new J(e),V.set(e,n);if(r)return r;if(r={},n.value=O(e),t){r.callback=t,r.next=null;var i=function(){Y(r)},a=function(){clearTimeout(r.next),r.next=setTimeout(i)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return r.patches=[],r.object=e,r.unobserve=function(){Y(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback)}(n,r),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},n.observers.set(t,new G(t,r)),r}function Y(e,t){void 0===t&&(t=!1);var r=V.get(e.object);Z(r.value,e.object,e.patches,"",t),e.patches.length&&F(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function Z(e,t,r,n,o){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var i=x(t),a=x(e),s=!1,c=a.length-1;c>=0;c--){var u=e[f=a[c]];if(!I(t,f)||void 0===t[f]&&void 0!==u&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(o&&r.push({op:"test",path:n+"/"+C(f),value:O(u)}),r.push({op:"remove",path:n+"/"+C(f)}),s=!0):(o&&r.push({op:"test",path:n,value:e}),r.push({op:"replace",path:n,value:t}));else{var l=t[f];"object"==typeof u&&null!=u&&"object"==typeof l&&null!=l&&Array.isArray(u)===Array.isArray(l)?Z(u,l,r,n+"/"+C(f),o):u!==l&&(o&&r.push({op:"test",path:n+"/"+C(f),value:O(u)}),r.push({op:"replace",path:n+"/"+C(f),value:O(l)}))}}if(s||i.length!=a.length)for(c=0;c<i.length;c++){var f;I(e,f=i[c])||void 0===t[f]||r.push({op:"add",path:n+"/"+C(f),value:O(t[f])})}}}function X(e,t,r){void 0===r&&(r=!1);var n=[];return Z(e,t,n,"",r),n}const Q=Object.assign({},e,t,{JsonPatchError:P,deepClone:O,escapePathComponent:C,unescapePathComponent:j}),ee=["string","number","bigint","symbol"],te=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];class re{constructor(e,t,r){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}re.uint=new re(0,"uint",!0),re.negint=new re(1,"negint",!0),re.bytes=new re(2,"bytes",!0),re.string=new re(3,"string",!0),re.array=new re(4,"array",!1),re.map=new re(5,"map",!1),re.tag=new re(6,"tag",!1),re.float=new re(7,"float",!0),re.false=new re(7,"false",!0),re.true=new re(7,"true",!0),re.null=new re(7,"null",!0),re.undefined=new re(7,"undefined",!0),re.break=new re(7,"break",!0);class ne{constructor(e,t,r){this.type=e,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const oe=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"==typeof globalThis.Buffer.isBuffer,ie=new TextDecoder,ae=new TextEncoder;function se(e){return oe&&globalThis.Buffer.isBuffer(e)}function ce(e){return e instanceof Uint8Array?se(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const ue=oe?(e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):me(e,t,r):(e,t,r)=>r-t>64?ie.decode(e.subarray(t,r)):me(e,t,r),le=oe?e=>e.length>64?globalThis.Buffer.from(e):ye(e):e=>e.length>64?ae.encode(e):ye(e),fe=e=>Uint8Array.from(e),he=oe?(e,t,r)=>se(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r):(e,t,r)=>e.slice(t,r),de=oe?(e,t)=>(e=e.map((e=>e instanceof Uint8Array?e:globalThis.Buffer.from(e))),ce(globalThis.Buffer.concat(e,t))):(e,t)=>{const r=new Uint8Array(t);let n=0;for(let t of e)n+t.length>r.length&&(t=t.subarray(0,r.length-n)),r.set(t,n),n+=t.length;return r},pe=oe?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function ye(e,t=1/0){let r;const n=e.length;let o=null;const i=[];for(let a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function me(e,t,r){const n=[];for(;t<r;){const o=e[t];let i=null,a=o>239?4:o>223?3:o>191?2:1;if(t+a<=r){let r,n,s,c;switch(a){case 1:o<128&&(i=o);break;case 2:r=e[t+1],128==(192&r)&&(c=(31&o)<<6|63&r,c>127&&(i=c));break;case 3:r=e[t+1],n=e[t+2],128==(192&r)&&128==(192&n)&&(c=(15&o)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:r=e[t+1],n=e[t+2],s=e[t+3],128==(192&r)&&128==(192&n)&&128==(192&s)&&(c=(15&o)<<18|(63&r)<<12|(63&n)<<6|63&s,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,a=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),t+=a}return function(e){const t=e.length;if(t<=we)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=we));return r}(n)}const we=4096;class be{constructor(e=256){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const r=t.length-(this.maxCursor-this.cursor)-1;t.set(e,r)}else{if(t){const e=t.length-(this.maxCursor-this.cursor)-1;e<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,e),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=pe(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,null===this._initReuseChunk&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(1===this.chunks.length){const r=this.chunks[0];e&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=he(r,0,this.cursor)}else t=de(this.chunks,this.cursor);return e&&this.reset(),t}}const ve=[];function ge(e,t,r){if(e.length-t<r)throw new Error("CBOR decode error: not enough data for type")}ve[23]=1,ve[24]=2,ve[25]=3,ve[26]=5,ve[27]=9;const Ee=[24,256,65536,4294967296,BigInt("18446744073709551616")];function _e(e,t,r){ge(e,t,1);const n=e[t];if(!0===r.strict&&n<Ee[0])throw new Error("CBOR decode error: integer encoded in more bytes than necessary (strict decode)");return n}function Se(e,t,r){ge(e,t,2);const n=e[t]<<8|e[t+1];if(!0===r.strict&&n<Ee[1])throw new Error("CBOR decode error: integer encoded in more bytes than necessary (strict decode)");return n}function Ae(e,t,r){ge(e,t,4);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(!0===r.strict&&n<Ee[2])throw new Error("CBOR decode error: integer encoded in more bytes than necessary (strict decode)");return n}function Ie(e,t,r){ge(e,t,8);const n=16777216*e[t]+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=16777216*e[t+4]+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],i=(BigInt(n)<<BigInt(32))+BigInt(o);if(!0===r.strict&&i<Ee[3])throw new Error("CBOR decode error: integer encoded in more bytes than necessary (strict decode)");if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(!0===r.allowBigInt)return i;throw new Error("CBOR decode error: integers outside of the safe integer range are not supported")}function xe(e,t){return Oe(e,0,t.value)}function Oe(e,t,r){if(r<Ee[0]){const n=Number(r);e.push([t|n])}else if(r<Ee[1]){const n=Number(r);e.push([24|t,n])}else if(r<Ee[2]){const n=Number(r);e.push([25|t,n>>>8,255&n])}else if(r<Ee[3]){const n=Number(r);e.push([26|t,n>>>24&255,n>>>16&255,n>>>8&255,255&n])}else{const n=BigInt(r);if(!(n<Ee[4]))throw new Error("CBOR decode error: encountered BigInt larger than allowable range");{const r=[27|t,0,0,0,0,0,0,0];let o=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));r[8]=255&o,o>>=8,r[7]=255&o,o>>=8,r[6]=255&o,o>>=8,r[5]=255&o,r[4]=255&i,i>>=8,r[3]=255&i,i>>=8,r[2]=255&i,i>>=8,r[1]=255&i,e.push(r)}}}xe.encodedSize=function(e){return Oe.encodedSize(e.value)},Oe.encodedSize=function(e){return e<Ee[0]?1:e<Ee[1]?2:e<Ee[2]?3:e<Ee[3]?5:9},xe.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0};const ke=BigInt(-1),Ce=BigInt(1);function je(e,t){const r=t.value,n="bigint"==typeof r?r*ke-Ce:-1*r-1;Oe(e,t.type.majorEncoded,n)}function De(e,t,r,n){ge(e,t,r+n);const o=he(e,t+r,t+r+n);return new ne(re.bytes,o,r+n)}function Te(e,t,r,n){return De(e,t,1,r)}function Pe(e){return void 0===e.encodedBytes&&(e.encodedBytes=e.type===re.string?le(e.value):e.value),e.encodedBytes}function Re(e,t){const r=Pe(t);Oe(e,t.type.majorEncoded,r.length),e.push(r)}function Ne(e,t,r,n,o){const i=r+n;ge(e,t,i);const a=new ne(re.string,ue(e,t+r,t+i),i);return!0===o.retainStringBytes&&(a.byteValue=he(e,t+r,t+i)),a}function Be(e,t,r,n){return Ne(e,t,1,r,n)}je.encodedSize=function(e){const t=e.value,r="bigint"==typeof t?t*ke-Ce:-1*t-1;return r<Ee[0]?1:r<Ee[1]?2:r<Ee[2]?3:r<Ee[3]?5:9},je.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0},Re.encodedSize=function(e){const t=Pe(e);return Oe.encodedSize(t.length)+t.length},Re.compareTokens=function(e,t){return r=Pe(e),n=Pe(t),r.length<n.length?-1:r.length>n.length?1:function(e,t){if(se(e)&&se(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}(r,n);var r,n};const Ue=Re;function Me(e,t,r,n){return new ne(re.array,n,r)}function Le(e,t,r,n){return Me(0,0,1,r)}function Fe(e,t){Oe(e,re.array.majorEncoded,t.value)}function $e(e,t,r,n){return new ne(re.map,n,r)}function ze(e,t,r,n){return $e(0,0,1,r)}function He(e,t){Oe(e,re.map.majorEncoded,t.value)}function qe(e,t,r,n){return new ne(re.tag,r,1)}function Ve(e,t){Oe(e,re.tag.majorEncoded,t.value)}function Je(e,t,r){if(r){if(!1===r.allowNaN&&Number.isNaN(e))throw new Error("CBOR decode error: NaN values are not supported");if(!1===r.allowInfinity&&(e===1/0||e===-1/0))throw new Error("CBOR decode error: Infinity values are not supported")}return new ne(re.float,e,t)}function Ge(e,t,r){const n=t.value;if(!1===n)e.push([20|re.float.majorEncoded]);else if(!0===n)e.push([21|re.float.majorEncoded]);else if(null===n)e.push([22|re.float.majorEncoded]);else if(void 0===n)e.push([23|re.float.majorEncoded]);else{let t,i=!1;r&&!0===r.float64||(Ze(n),t=Xe(Ye,1),n===t||Number.isNaN(n)?(Ye[0]=249,e.push(Ye.slice(0,3)),i=!0):(Qe(n),t=et(Ye,1),n===t&&(Ye[0]=250,e.push(Ye.slice(0,5)),i=!0))),i||(o=n,We.setFloat64(0,o,!1),t=tt(Ye,1),Ye[0]=251,e.push(Ye.slice(0,9)))}var o}Fe.compareTokens=xe.compareTokens,Fe.encodedSize=function(e){return Oe.encodedSize(e.value)},He.compareTokens=xe.compareTokens,He.encodedSize=function(e){return Oe.encodedSize(e.value)},Ve.compareTokens=xe.compareTokens,Ve.encodedSize=function(e){return Oe.encodedSize(e.value)},Ge.encodedSize=function(e,t){const r=e.value;if(!1===r||!0===r||null==r)return 1;if(!t||!0!==t.float64){Ze(r);let e=Xe(Ye,1);if(r===e||Number.isNaN(r))return 3;if(Qe(r),e=et(Ye,1),r===e)return 5}return 9};const Ke=new ArrayBuffer(9),We=new DataView(Ke,1),Ye=new Uint8Array(Ke,0);function Ze(e){if(e===1/0)We.setUint16(0,31744,!1);else if(e===-1/0)We.setUint16(0,64512,!1);else if(Number.isNaN(e))We.setUint16(0,32256,!1);else{We.setFloat32(0,e);const t=We.getUint32(0),r=(2139095040&t)>>23,n=8388607&t;if(255===r)We.setUint16(0,31744,!1);else if(0===r)We.setUint16(0,(2147483648&e)>>16|n>>13,!1);else{const e=r-127;e<-24?We.setUint16(0,0):e<-14?We.setUint16(0,(2147483648&t)>>16|1<<24+e,!1):We.setUint16(0,(2147483648&t)>>16|e+15<<10|n>>13,!1)}}}function Xe(e,t){if(e.length-t<2)throw new Error("CBOR decode error: not enough data for float16");const r=(e[t]<<8)+e[t+1];if(31744===r)return 1/0;if(64512===r)return-1/0;if(32256===r)return NaN;const n=r>>10&31,o=1023&r;let i;return i=0===n?o*2**-24:31!==n?(o+1024)*2**(n-25):0===o?1/0:NaN,32768&r?-i:i}function Qe(e){We.setFloat32(0,e,!1)}function et(e,t){if(e.length-t<4)throw new Error("CBOR decode error: not enough data for float32");const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function tt(e,t){if(e.length-t<8)throw new Error("CBOR decode error: not enough data for float64");const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}function rt(e,t,r){throw new Error(`CBOR decode error: encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function nt(e){return()=>{throw new Error(`CBOR decode error: ${e}`)}}Ge.compareTokens=xe.compareTokens;const ot=[];for(let e=0;e<=23;e++)ot[e]=rt;ot[24]=function(e,t,r,n){return new ne(re.uint,_e(e,t+1,n),2)},ot[25]=function(e,t,r,n){return new ne(re.uint,Se(e,t+1,n),3)},ot[26]=function(e,t,r,n){return new ne(re.uint,Ae(e,t+1,n),5)},ot[27]=function(e,t,r,n){return new ne(re.uint,Ie(e,t+1,n),9)},ot[28]=rt,ot[29]=rt,ot[30]=rt,ot[31]=rt;for(let e=32;e<=55;e++)ot[e]=rt;ot[56]=function(e,t,r,n){return new ne(re.negint,-1-_e(e,t+1,n),2)},ot[57]=function(e,t,r,n){return new ne(re.negint,-1-Se(e,t+1,n),3)},ot[58]=function(e,t,r,n){return new ne(re.negint,-1-Ae(e,t+1,n),5)},ot[59]=function(e,t,r,n){const o=Ie(e,t+1,n);if("bigint"!=typeof o){const e=-1-o;if(e>=Number.MIN_SAFE_INTEGER)return new ne(re.negint,e,9)}if(!0!==n.allowBigInt)throw new Error("CBOR decode error: integers outside of the safe integer range are not supported");return new ne(re.negint,ke-BigInt(o),9)},ot[60]=rt,ot[61]=rt,ot[62]=rt,ot[63]=rt;for(let e=64;e<=87;e++)ot[e]=Te;ot[88]=function(e,t,r,n){return De(e,t,2,_e(e,t+1,n))},ot[89]=function(e,t,r,n){return De(e,t,3,Se(e,t+1,n))},ot[90]=function(e,t,r,n){return De(e,t,5,Ae(e,t+1,n))},ot[91]=function(e,t,r,n){const o=Ie(e,t+1,n);if("bigint"==typeof o)throw new Error("CBOR decode error: 64-bit integer bytes lengths not supported");return De(e,t,9,o)},ot[92]=rt,ot[93]=rt,ot[94]=rt,ot[95]=nt("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)ot[e]=Be;ot[120]=function(e,t,r,n){return Ne(e,t,2,_e(e,t+1,n),n)},ot[121]=function(e,t,r,n){return Ne(e,t,3,Se(e,t+1,n),n)},ot[122]=function(e,t,r,n){return Ne(e,t,5,Ae(e,t+1,n),n)},ot[123]=function(e,t,r,n){const o=Ie(e,t+1,n);if("bigint"==typeof o)throw new Error("CBOR decode error: 64-bit integer string lengths not supported");return Ne(e,t,9,o,n)},ot[124]=rt,ot[125]=rt,ot[126]=rt,ot[127]=nt("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)ot[e]=Le;ot[152]=function(e,t,r,n){return Me(0,0,2,_e(e,t+1,n))},ot[153]=function(e,t,r,n){return Me(0,0,3,Se(e,t+1,n))},ot[154]=function(e,t,r,n){return Me(0,0,5,Ae(e,t+1,n))},ot[155]=function(e,t,r,n){const o=Ie(e,t+1,n);if("bigint"==typeof o)throw new Error("CBOR decode error: 64-bit integer array lengths not supported");return Me(0,0,9,o)},ot[156]=rt,ot[157]=rt,ot[158]=rt,ot[159]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error("CBOR decode error: indefinite length items not allowed");return Me(0,0,1,1/0)};for(let e=160;e<=183;e++)ot[e]=ze;ot[184]=function(e,t,r,n){return $e(0,0,2,_e(e,t+1,n))},ot[185]=function(e,t,r,n){return $e(0,0,3,Se(e,t+1,n))},ot[186]=function(e,t,r,n){return $e(0,0,5,Ae(e,t+1,n))},ot[187]=function(e,t,r,n){const o=Ie(e,t+1,n);if("bigint"==typeof o)throw new Error("CBOR decode error: 64-bit integer map lengths not supported");return $e(0,0,9,o)},ot[188]=rt,ot[189]=rt,ot[190]=rt,ot[191]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error("CBOR decode error: indefinite length items not allowed");return $e(0,0,1,1/0)};for(let e=192;e<=215;e++)ot[e]=qe;ot[216]=function(e,t,r,n){return new ne(re.tag,_e(e,t+1,n),2)},ot[217]=function(e,t,r,n){return new ne(re.tag,Se(e,t+1,n),3)},ot[218]=function(e,t,r,n){return new ne(re.tag,Ae(e,t+1,n),5)},ot[219]=function(e,t,r,n){return new ne(re.tag,Ie(e,t+1,n),9)},ot[220]=rt,ot[221]=rt,ot[222]=rt,ot[223]=rt;for(let e=224;e<=243;e++)ot[e]=nt("simple values are not supported");ot[244]=rt,ot[245]=rt,ot[246]=rt,ot[247]=function(e,t,r,n){if(!1===n.allowUndefined)throw new Error("CBOR decode error: undefined values are not supported");return!0===n.coerceUndefinedToNull?new ne(re.null,null,1):new ne(re.undefined,void 0,1)},ot[248]=nt("simple values are not supported"),ot[249]=function(e,t,r,n){return Je(Xe(e,t+1),3,n)},ot[250]=function(e,t,r,n){return Je(et(e,t+1),5,n)},ot[251]=function(e,t,r,n){return Je(tt(e,t+1),9,n)},ot[252]=rt,ot[253]=rt,ot[254]=rt,ot[255]=function(e,t,r,n){if(!1===n.allowIndefinite)throw new Error("CBOR decode error: indefinite length items not allowed");return new ne(re.break,void 0,1)};const it=[];for(let e=0;e<24;e++)it[e]=new ne(re.uint,e,1);for(let e=-1;e>=-24;e--)it[31-e]=new ne(re.negint,e,1);it[64]=new ne(re.bytes,new Uint8Array(0),1),it[96]=new ne(re.string,"",1),it[128]=new ne(re.array,0,1),it[160]=new ne(re.map,0,1),it[244]=new ne(re.false,!1,1),it[245]=new ne(re.true,!0,1),it[246]=new ne(re.null,null,1);const at={float64:!1,mapSorter:function(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const o=r.type.major,i=st[o].compareTokens(r,n);return 0===i&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i},quickEncodeToken:function(e){switch(e.type){case re.false:return fe([244]);case re.true:return fe([245]);case re.null:return fe([246]);case re.bytes:return e.value.length?void 0:fe([64]);case re.string:return""===e.value?fe([96]):void 0;case re.array:return 0===e.value?fe([128]):void 0;case re.map:return 0===e.value?fe([160]):void 0;case re.uint:return e.value<24?fe([Number(e.value)]):void 0;case re.negint:if(e.value>=-24)return fe([31-Number(e.value)])}}},st=function(){const e=[];return e[re.uint.major]=xe,e[re.negint.major]=je,e[re.bytes.major]=Re,e[re.string.major]=Ue,e[re.array.major]=Fe,e[re.map.major]=He,e[re.tag.major]=Ve,e[re.float.major]=Ge,e}(),ct=new be;class ut{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do{if(t.obj===e)return!0}while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error("CBOR encode error: object contains circular references");return new ut(t,e)}}const lt={null:new ne(re.null,null),undefined:new ne(re.undefined,void 0),true:new ne(re.true,!0),false:new ne(re.false,!1),emptyArray:new ne(re.array,0),emptyMap:new ne(re.map,0)},ft={number:(e,t,r,n)=>Number.isInteger(e)&&Number.isSafeInteger(e)?new ne(e>=0?re.uint:re.negint,e):new ne(re.float,e),bigint:(e,t,r,n)=>e>=BigInt(0)?new ne(re.uint,e):new ne(re.negint,e),Uint8Array:(e,t,r,n)=>new ne(re.bytes,e),string:(e,t,r,n)=>new ne(re.string,e),boolean:(e,t,r,n)=>e?lt.true:lt.false,null:(e,t,r,n)=>lt.null,undefined:(e,t,r,n)=>lt.undefined,ArrayBuffer:(e,t,r,n)=>new ne(re.bytes,new Uint8Array(e)),DataView:(e,t,r,n)=>new ne(re.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),Array(e,t,r,n){if(!e.length)return!0===r.addBreakTokens?[lt.emptyArray,new ne(re.break)]:lt.emptyArray;n=ut.createCheck(n,e);const o=[];let i=0;for(const t of e)o[i++]=ht(t,r,n);return r.addBreakTokens?[new ne(re.array,e.length),o,new ne(re.break)]:[new ne(re.array,e.length),o]},Object(e,t,r,n){const o="Object"!==t,i=o?e.keys():Object.keys(e),a=o?e.size:i.length;if(!a)return!0===r.addBreakTokens?[lt.emptyMap,new ne(re.break)]:lt.emptyMap;n=ut.createCheck(n,e);const s=[];let c=0;for(const t of i)s[c++]=[ht(t,r,n),ht(o?e.get(t):e[t],r,n)];return function(e,t){t.mapSorter&&e.sort(t.mapSorter)}(s,r),r.addBreakTokens?[new ne(re.map,a),s,new ne(re.break)]:[new ne(re.map,a),s]}};ft.Map=ft.Object,ft.Buffer=ft.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))ft[`${e}Array`]=ft.DataView;function ht(e,t={},r){const n=function(e){if(null===e)return"null";if(void 0===e)return"undefined";if(!0===e||!1===e)return"boolean";const t=typeof e;if(ee.includes(t))return t;if("function"===t)return"Function";if(Array.isArray(e))return"Array";if(function(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}(e))return"Buffer";const r=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(te.includes(t))return t}(e);return r||"Object"}(e),o=t&&t.typeEncoders&&t.typeEncoders[n]||ft[n];if("function"==typeof o){const i=o(e,n,t,r);if(null!=i)return i}const i=ft[n];if(!i)throw new Error(`CBOR encode error: unsupported type: ${n}`);return i(e,n,t,r)}function dt(e,t,r,n){if(Array.isArray(t))for(const o of t)dt(e,o,r,n);else r[t.type.major](e,t,n)}function pt(e,t,r){const n=ht(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const e=r.quickEncodeToken(n);if(e)return e;const o=t[n.type.major];if(o.encodedSize){const e=o.encodedSize(n,r),t=new be(e);if(o(t,n,r),1!==t.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return ce(t.chunks[0])}}return ct.reset(),dt(ct,n,t,r),ct.toBytes(!0)}const yt={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class mt{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){const e=this.data[this.pos];let t=it[e];if(void 0===t){const r=ot[e];if(!r)throw new Error(`CBOR decode error: no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const n=31&e;t=r(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}}const wt=Symbol.for("DONE"),bt=Symbol.for("BREAK");function vt(e,t){if(e.done())return wt;const r=e.next();if(r.type===re.break)return bt;if(r.type.terminal)return r.value;if(r.type===re.array)return function(e,t,r){const n=[];for(let o=0;o<e.value;o++){const i=vt(t,r);if(i===bt){if(e.value===1/0)break;throw new Error("CBOR decode error: got unexpected break to lengthed array")}if(i===wt)throw new Error(`CBOR decode error: found array but not enough entries (got ${o}, expected ${e.value})`);n[o]=i}return n}(r,e,t);if(r.type===re.map)return function(e,t,r){const n=!0===r.useMaps,o=n?void 0:{},i=n?new Map:void 0;for(let a=0;a<e.value;a++){const s=vt(t,r);if(s===bt){if(e.value===1/0)break;throw new Error("CBOR decode error: got unexpected break to lengthed map")}if(s===wt)throw new Error(`CBOR decode error: found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(!0!==n&&"string"!=typeof s)throw new Error(`CBOR decode error: non-string keys not supported (got ${typeof s})`);const c=vt(t,r);if(c===wt)throw new Error(`CBOR decode error: found map but not enough entries (got ${a} [no value], expected ${e.value})`);n?i.set(s,c):o[s]=c}return n?i:o}(r,e,t);if(r.type===re.tag){if(t.tags&&"function"==typeof t.tags[r.value]){const n=vt(e,t);return t.tags[r.value](n)}throw new Error(`CBOR decode error: tag not supported (${r.value})`)}throw new Error("unsupported")}var gt=Math.pow(2,31),Et=Math.pow(2,7),_t=Math.pow(2,14),St=Math.pow(2,21),At=Math.pow(2,28),It=Math.pow(2,35),xt=Math.pow(2,42),Ot=Math.pow(2,49),kt=Math.pow(2,56),Ct=Math.pow(2,63);const jt={encode:function e(t,r,n){r=r||[];for(var o=n=n||0;t>=gt;)r[n++]=255&t|128,t/=128;for(;-128&t;)r[n++]=255&t|128,t>>>=7;return r[n]=0|t,e.bytes=n-o+1,r},decode:function e(t,r){var n,o=0,i=0,a=r=r||0,s=t.length;do{if(a>=s)throw e.bytes=0,new RangeError("Could not decode varint");n=t[a++],o+=i<28?(127&n)<<i:(127&n)*Math.pow(2,i),i+=7}while(n>=128);return e.bytes=a-r,o},encodingLength:function(e){return e<Et?1:e<_t?2:e<St?3:e<At?4:e<It?5:e<xt?6:e<Ot?7:e<kt?8:e<Ct?9:10}},Dt=e=>[jt.decode(e),jt.decode.bytes],Tt=(e,t,r=0)=>(jt.encode(e,t,r),t),Pt=e=>jt.encodingLength(e),Rt=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}),Nt=(e,t)=>{const r=t.byteLength,n=Pt(e),o=n+Pt(r),i=new Uint8Array(o+r);return Tt(e,i,0),Tt(r,i,n),i.set(t,o),new Ut(e,r,t,i)},Bt=e=>{const t=Rt(e),[r,n]=Dt(t),[o,i]=Dt(t.subarray(n)),a=t.subarray(n+i);if(a.byteLength!==o)throw new Error("Incorrect length");return new Ut(r,o,a,t)};class Ut{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Mt=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),a=i.charCodeAt(0);if(255!==r[a])throw new TypeError(i+" is ambiguous");r[a]=o}var s=e.length,c=e.charAt(0),u=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function f(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,o=0;e[t]===c;)n++,t++;for(var i=(e.length-t)*u+1>>>0,a=new Uint8Array(i);e[t];){var l=r[e.charCodeAt(t)];if(255===l)return;for(var f=0,h=i-1;(0!==l||f<o)&&-1!==h;h--,f++)l+=s*a[h]>>>0,a[h]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=f,t++}if(" "!==e[t]){for(var d=i-o;d!==i&&0===a[d];)d++;for(var p=new Uint8Array(n+(i-d)),y=n;d!==i;)p[y++]=a[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,o=0,i=t.length;o!==i&&0===t[o];)o++,r++;for(var a=(i-o)*l+1>>>0,u=new Uint8Array(a);o!==i;){for(var f=t[o],h=0,d=a-1;(0!==f||h<n)&&-1!==d;d--,h++)f+=256*u[d]>>>0,u[d]=f%s>>>0,f=f/s>>>0;if(0!==f)throw new Error("Non-zero carry");n=h,o++}for(var p=a-n;p!==a&&0===u[p];)p++;for(var y=c.repeat(r);p<a;++p)y+=e.charAt(u[p]);return y},decodeUnsafe:f,decode:function(e){var r=f(e);if(r)return r;throw new Error(`Non-${t} character`)}}};class Lt{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ft{constructor(e,t,r){this.name=e,this.prefix=t,this.baseDecode=r}decode(e){if("string"==typeof e){if(e[0]===this.prefix)return this.baseDecode(e.slice(1));throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}throw Error("Can only multibase decode strings")}or(e){return zt(this,e)}}class $t{constructor(e){this.decoders=e}or(e){return zt(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const zt=(e,t)=>new $t({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ht{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Lt(e,t,r),this.decoder=new Ft(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const qt=({name:e,prefix:t,encode:r,decode:n})=>new Ht(e,t,r,n),Vt=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:o}=Mt(r,t);return qt({prefix:e,name:t,encode:n,decode:e=>Rt(o(e))})},Jt=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>qt({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],o=(1<<r)-1;let i="",a=0,s=0;for(let n=0;n<e.length;++n)for(s=s<<8|e[n],a+=8;a>r;)a-=r,i+=t[o&s>>a];if(a&&(i+=t[o&s<<r-a]),n)for(;i.length*r&7;)i+="=";return i})(e,n,r),decode:t=>((e,t,r,n)=>{const o={};for(let e=0;e<t.length;++e)o[t[e]]=e;let i=e.length;for(;"="===e[i-1];)--i;const a=new Uint8Array(i*r/8|0);let s=0,c=0,u=0;for(let t=0;t<i;++t){const i=o[e[t]];if(void 0===i)throw new SyntaxError(`Non-${n} character`);c=c<<r|i,s+=r,s>=8&&(s-=8,a[u++]=255&c>>s)}if(s>=r||255&c<<8-s)throw new SyntaxError("Unexpected end of data");return a})(t,n,r,e)}),Gt=Vt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Kt=Vt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Wt=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Yt=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Zt=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Xt=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Qt=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),er=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),tr=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),rr=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),nr=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});class or{constructor(e,t,r,n){this.code=t,this.version=e,this.multihash=r,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:dr,byteLength:dr,code:hr,version:hr,multihash:hr,bytes:hr,_baseCache:dr,asCID:dr})}toV0(){if(0===this.version)return this;{const{code:e,multihash:t}=this;if(e!==cr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==ur)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return or.createV0(t)}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,r=Nt(e,t);return or.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&((t=this.multihash)===(r=e.multihash)||t.code===r.code&&t.size===r.size&&((e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0})(t.bytes,r.bytes));var t,r}toString(e){const{bytes:t,version:r,_baseCache:n}=this;return 0===r?ar(t,n,e||Gt.encoder):sr(t,n,e||Wt.encoder)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return pr(/^0\.0/,yr),!(!e||!e[fr]&&e.asCID!==e)}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof or)return e;if(null!=e&&e.asCID===e){const{version:t,code:r,multihash:n,bytes:o}=e;return new or(t,r,n,o||lr(t,r,n.bytes))}if(null!=e&&!0===e[fr]){const{version:t,multihash:r,code:n}=e,o=Bt(r);return or.create(t,n,o)}return null}static create(e,t,r){if("number"!=typeof t)throw new Error("String codecs are no longer supported");switch(e){case 0:if(t!==cr)throw new Error(`Version 0 CID must use dag-pb (code: ${cr}) block encoding`);return new or(e,t,r,r.bytes);case 1:{const n=lr(e,t,r.bytes);return new or(e,t,r,n)}default:throw new Error("Invalid version")}}static createV0(e){return or.create(0,cr,e)}static createV1(e,t){return or.create(1,e,t)}static decode(e){const[t,r]=or.decodeFirst(e);if(r.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=or.inspectBytes(e),r=t.size-t.multihashSize,n=Rt(e.subarray(r,r+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");const o=n.subarray(t.multihashSize-t.digestSize),i=new Ut(t.multihashCode,t.digestSize,o,n);return[0===t.version?or.createV0(i):or.createV1(t.codec,i),e.subarray(t.size)]}static inspectBytes(e){let t=0;const r=()=>{const[r,n]=Dt(e.subarray(t));return t+=n,r};let n=r(),o=cr;if(18===n?(n=0,t=0):1===n&&(o=r()),0!==n&&1!==n)throw new RangeError(`Invalid CID version ${n}`);const i=t,a=r(),s=r(),c=t+s;return{version:n,codec:o,multihashCode:a,digestSize:s,multihashSize:c-i,size:c}}static parse(e,t){const[r,n]=ir(e,t),o=or.decode(n);return o._baseCache.set(r,e),o}}const ir=(e,t)=>{switch(e[0]){case"Q":{const r=t||Gt;return[Gt.prefix,r.decode(`${Gt.prefix}${e}`)]}case Gt.prefix:{const r=t||Gt;return[Gt.prefix,r.decode(e)]}case Wt.prefix:{const r=t||Wt;return[Wt.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},ar=(e,t,r)=>{const{prefix:n}=r;if(n!==Gt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const o=t.get(n);if(null==o){const o=r.encode(e).slice(1);return t.set(n,o),o}return o},sr=(e,t,r)=>{const{prefix:n}=r,o=t.get(n);if(null==o){const o=r.encode(e);return t.set(n,o),o}return o},cr=112,ur=18,lr=(e,t,r)=>{const n=Pt(e),o=n+Pt(t),i=new Uint8Array(o+r.byteLength);return Tt(e,i,0),Tt(t,i,n),i.set(r,o),i},fr=Symbol.for("@ipld/js-cid/CID"),hr={writable:!1,configurable:!1,enumerable:!0},dr={writable:!1,enumerable:!1,configurable:!1},pr=(e,t)=>{if(!e.test("0.0.0-dev"))throw new Error(t);console.warn(t)},yr="CID.isCID(v) is deprecated and will be removed in the next major release.\nFollowing code pattern:\n\nif (CID.isCID(value)) {\n  doSomethingWithCID(value)\n}\n\nIs replaced with:\n\nconst cid = CID.asCID(value)\nif (cid) {\n  // Make sure to use cid instead of value\n  doSomethingWithCID(cid)\n}\n",mr={float64:!0,typeEncoders:{Object:function(e){if(e.asCID!==e)return null;const t=or.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new ne(re.tag,42),new ne(re.bytes,r)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}},wr={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};wr.tags[42]=function(e){if(0!==e[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return or.decode(e.subarray(1))};const br="dag-cbor",vr=113,gr=e=>{return t=e,r=mr,r=Object.assign({},at,r),pt(t,st,r);var t,r},Er=e=>function(e,t){if(!(e instanceof Uint8Array))throw new Error("CBOR decode error: data to decode must be a Uint8Array");const r=(t=Object.assign({},yt,t)).tokenizer||new mt(e,t),n=vt(r,t);if(n===wt)throw new Error("CBOR decode error: did not find any content to decode");if(n===bt)throw new Error("CBOR decode error: got unexpected break");if(!r.done())throw new Error("CBOR decode error: too many terminals, data makes no sense");return n}(e,wr);function _r(e,t){t||(t=e.reduce(((e,t)=>e+t.length),0));const r=new Uint8Array(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return r}const Sr=qt({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),Ar=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ir=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),xr=Vt({prefix:"9",name:"base10",alphabet:"0123456789"}),Or=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),kr=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Cr=Vt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),jr=Vt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Dr=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Tr=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Pr=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Rr=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Nr=({name:e,code:t,encode:r})=>new Br(e,t,r);class Br{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Nt(this.code,t):t.then((e=>Nt(this.code,e)))}throw Error("Unknown type, must be binary type")}}const Ur=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Mr=Nr({name:"sha2-256",code:18,encode:Ur("SHA-256")}),Lr=Nr({name:"sha2-512",code:19,encode:Ur("SHA-512")}),Fr=Rt,$r={code:0,name:"identity",encode:Fr,digest:e=>Nt(0,Fr(e))},zr="raw",Hr=85,qr=e=>Rt(e),Vr=e=>Rt(e),Jr=new TextEncoder,Gr=new TextDecoder,Kr="json",Wr=512,Yr=e=>Jr.encode(JSON.stringify(e)),Zr=e=>JSON.parse(Gr.decode(e)),Xr={...s,...c,...u,...l,...f,...i,...h,...o,...d};function Qr(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const en=Qr("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),tn=Qr("ascii","a",(e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}),(e=>{e=e.substring(1);const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})),rn={utf8:en,"utf-8":en,hex:Xr.base16,latin1:tn,ascii:tn,binary:tn,...Xr};function nn(e,t="utf8"){const r=rn[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}function on(e,t="utf8"){const r=rn[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}var an,sn=r(416);!function(e){e[e.PREFER_CACHE=0]="PREFER_CACHE",e[e.SYNC_ALWAYS=1]="SYNC_ALWAYS",e[e.NEVER_SYNC=2]="NEVER_SYNC"}(an||(an={}));var cn=r(465);const un=({enumerable:e=!0,configurable:t=!1}={})=>({enumerable:e,configurable:t,writable:!1}),ln=function*(e,t){if(null!=e&&!(e instanceof Uint8Array))for(const[r,n]of Object.entries(e)){const e=[...t,r];if(null!=n&&"object"==typeof n)if(Array.isArray(n))for(const[t,r]of n.entries()){const n=[...e,t],o=or.asCID(r);o?yield[n.join("/"),o]:"object"==typeof r&&(yield*ln(r,n))}else{const t=or.asCID(n);t?yield[e.join("/"),t]:yield*ln(n,e)}}},fn=function*(e,t){if(null!=e)for(const[r,n]of Object.entries(e)){const e=[...t,r];if(yield e.join("/"),!(null==n||n instanceof Uint8Array||"object"!=typeof n||or.asCID(n)))if(Array.isArray(n))for(const[t,r]of n.entries()){const n=[...e,t];yield n.join("/"),"object"!=typeof r||or.asCID(r)||(yield*fn(r,n))}else yield*fn(n,e)}};class hn{constructor({cid:e,bytes:t,value:r}){if(!e||!t||void 0===r)throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=r,this.asBlock=this,Object.defineProperties(this,{cid:un(),bytes:un(),value:un(),asBlock:un()})}links(){return ln(this.value,[])}tree(){return fn(this.value,[])}get(e="/"){return((e,t)=>{let r=e;for(const[e,n]of t.entries()){if(r=r[n],null==r)throw new Error(`Object has no property at ${t.slice(0,e+1).map((e=>`[${JSON.stringify(e)}]`)).join("")}`);const o=or.asCID(r);if(o)return{value:o,remaining:t.slice(e+1).join("/")}}return{value:r}})(this.value,e.split("/").filter(Boolean))}}var dn=r(676);const pn=206;function yn(e){const t=dn.decode(e),r=dn.decode.bytes;return[t,e.slice(r),r]}function mn(e){const t=wn(e);if(t instanceof Error)throw t;return t}function wn(e){const[t,r]=yn(e);if(0!==(n=t)&&1!==n)return new Error(`Unknown CID version ${t}`);var n;const[o,i]=yn(r),[,a,s]=yn(i),[c,,u]=yn(a),l=i.slice(0,s+u+c),f=i.slice(s+u+c);return[or.create(t,o,Bt(l)),f]}function bn(e){let t,r,n;return"object"==typeof e?(t=e.hashFunction,r=e.expiring,n=e.tags):t=e,(e,o,i)=>{if(null!=i.value)i.value=gn(i.value,t,r,n);else{if(null==i.get)throw"Only put a Memoize() decorator on a method or get accessor.";i.get=gn(i.get,t,r,n)}}}const vn=new Map;function gn(e,t,r=0,n){const o=Symbol("__memoized_map__");return function(...i){let a;this.hasOwnProperty(o)||Object.defineProperty(this,o,{configurable:!1,enumerable:!1,writable:!1,value:new Map});let s=this[o];if(Array.isArray(n))for(const e of n)vn.has(e)?vn.get(e).push(s):vn.set(e,[s]);if(t||i.length>0||r>0){let n;n=!0===t?i.map((e=>e.toString())).join("!"):t?t.apply(this,i):i[0];const o=`${n}__timestamp`;let c=!1;if(r>0)if(s.has(o)){let e=s.get(o);c=Date.now()-e>r}else c=!0;s.has(n)&&!c?a=s.get(n):(a=e.apply(this,i),s.set(n,a),r>0&&s.set(o,Date.now()))}else{const t=this;s.has(t)?a=s.get(t):(a=e.apply(this,i),s.set(t,a))}return a}}const En={tile:0,"caip10-link":1};class _n{}_n.nameByCode=function(e){const t=Object.entries(En).find((([,t])=>t===e));if(t)return t[0];throw new Error(`No stream type registered for index ${e}`)},_n.codeByName=function(e){const t=En[e];if(void 0!==t)return t;throw new Error(`No stream type registered for name ${e}`)};var Sn,An,In=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},xn=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},On=function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},kn=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};function Cn(e){const[t,r]=yn(e);if(t!==pn)return new Error("fromBytes: invalid streamid, does not include streamid codec");const[n,o]=yn(r),i=wn(o);if(i instanceof Error)return i;const[a,s]=i;return s.length>0?new Error("Invalid StreamID: contains commit"):new Tn(n,a)}function jn(e){const t=e.replace("ceramic://","").replace("/ceramic/",""),r=t.includes("commit")?t.split("?")[0]:t;return Cn(Cr.decode(r))}const Dn=Symbol.for("@ceramicnetwork/streamid/StreamID");class Tn{constructor(e,t){if(this._tag=Dn,Sn.set(this,void 0),An.set(this,void 0),!e&&0!==e)throw new Error("constructor: type required");if(!t)throw new Error("constructor: cid required");On(this,Sn,"string"==typeof e?_n.codeByName(e):e,"f"),On(this,An,"string"==typeof t?or.parse(t):t,"f")}static isInstance(e){return"object"==typeof e&&"_tag"in e&&e._tag===Dn}static async fromGenesis(e,t){const r=await(async({value:e,codec:t,hasher:r})=>{if(void 0===e)throw new Error('Missing required argument "value"');if(!t||!r)throw new Error("Missing required argument: codec or hasher");const n=t.encode(e),o=await r.digest(n),i=or.create(1,t.code,o);return new hn({value:e,bytes:n,cid:i})})({value:t,codec:a,hasher:Mr});return new Tn(e,r.cid)}get type(){return kn(this,Sn,"f")}get typeName(){return _n.nameByCode(kn(this,Sn,"f"))}get cid(){return kn(this,An,"f")}get bytes(){return _r([dn.encode(pn),dn.encode(this.type),this.cid.bytes])}get baseID(){return new Tn(kn(this,Sn,"f"),kn(this,An,"f"))}equals(e){return!!Tn.isInstance(e)&&this.type===e.type&&this.cid.equals(e.cid)}toString(){return Cr.encode(this.bytes)}toUrl(){return`ceramic://${this.toString()}`}[(Sn=new WeakMap,An=new WeakMap,Symbol.for("nodejs.util.inspect.custom"))](){return`StreamID(${this.toString()})`}[Symbol.toPrimitive](){return this.toString()}}Tn.fromBytes=function(e){const t=Cn(e);if(t instanceof Error)throw t;return t},Tn.fromBytesNoThrow=Cn,Tn.fromString=function(e){const t=jn(e);if(t instanceof Error)throw t;return t},Tn.fromStringNoThrow=jn,In([bn(),xn("design:type",String),xn("design:paramtypes",[])],Tn.prototype,"typeName",null),In([bn(),xn("design:type",Uint8Array),xn("design:paramtypes",[])],Tn.prototype,"bytes",null),In([bn(),xn("design:type",Tn),xn("design:paramtypes",[])],Tn.prototype,"baseID",null),In([bn(),xn("design:type",Function),xn("design:paramtypes",[]),xn("design:returntype",String)],Tn.prototype,"toString",null),In([bn(),xn("design:type",Function),xn("design:paramtypes",[]),xn("design:returntype",String)],Tn.prototype,"toUrl",null);var Pn,Rn,Nn,Bn=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Un=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Mn=function(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r},Ln=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};function Fn(e){const[t,r]=yn(e);if(t!==pn)return new Error("fromBytes: invalid streamid, does not include streamid codec");const[n,o]=yn(r),i=mn(o);if(i instanceof Error)return i;const[a,s]=i;if(0===s.length)return new Error("No commit information provided");if(1===s.length)return new qn(n,a,s[0]);{const[e]=mn(s);return new qn(n,a,e)}}function $n(e){const t=e.replace("ceramic://","").replace("/ceramic/","");if(t.includes("commit")){const e=t.split("?")[1].split("=")[1],r=t.split("?")[0];return Hn(Tn.fromString(r),e)}return Fn(Cr.decode(t))}const zn=Symbol.for("@ceramicnetwork/streamid/CommitID");function Hn(e,t){return new qn(e.type,e.cid,t)}class qn{constructor(e,t,r=null){if(this._tag=zn,Pn.set(this,void 0),Rn.set(this,void 0),Nn.set(this,void 0),!e&&0!==e)throw new Error("constructor: type required");if(!t)throw new Error("constructor: cid required");Mn(this,Pn,"string"==typeof e?_n.codeByName(e):e,"f"),Mn(this,Rn,"string"==typeof t?or.parse(t):t,"f"),Mn(this,Nn,function(e,t=null){if(!t)return null;const r=function(e){try{return"string"==typeof e?or.parse(e):or.asCID(e)}catch{return}}(t);if(r)return e.equals(r)?null:r;if("0"===String(t))return null;throw new Error("Cannot specify commit as a number except to request commit 0 (the genesis commit)")}(Ln(this,Rn,"f"),r),"f")}static isInstance(e){return"object"==typeof e&&"_tag"in e&&e._tag===zn}get baseID(){return new Tn(Ln(this,Pn,"f"),Ln(this,Rn,"f"))}get type(){return Ln(this,Pn,"f")}get typeName(){return _n.nameByCode(Ln(this,Pn,"f"))}get cid(){return Ln(this,Rn,"f")}get commit(){return Ln(this,Nn,"f")||Ln(this,Rn,"f")}get bytes(){const e=dn.encode(pn),t=dn.encode(this.type),r=Ln(this,Nn,"f")?.bytes||new Uint8Array([0]);return _r([e,t,this.cid.bytes,r])}equals(e){return this.type===e.type&&this.cid.equals(e.cid)&&this.commit.equals(e.commit)}toString(){return Cr.encode(this.bytes)}toUrl(){return`ceramic://${this.toString()}`}[(Pn=new WeakMap,Rn=new WeakMap,Nn=new WeakMap,Symbol.for("nodejs.util.inspect.custom"))](){return`CommitID(${this.toString()})`}[Symbol.toPrimitive](){return this.toString()}}qn.fromBytes=function(e){const t=Fn(e);if(t instanceof Error)throw t;return t},qn.fromBytesNoThrow=Fn,qn.fromString=function(e){const t=$n(e);if(t instanceof Error)throw t;return t},qn.fromStringNoThrow=$n,qn.make=Hn,Bn([bn(),Un("design:type",Tn),Un("design:paramtypes",[])],qn.prototype,"baseID",null),Bn([bn(),Un("design:type",String),Un("design:paramtypes",[])],qn.prototype,"typeName",null),Bn([bn(),Un("design:type",or),Un("design:paramtypes",[])],qn.prototype,"commit",null),Bn([bn(),Un("design:type",Uint8Array),Un("design:paramtypes",[])],qn.prototype,"bytes",null),Bn([bn(),Un("design:type",Function),Un("design:paramtypes",[]),Un("design:returntype",String)],qn.prototype,"toString",null),Bn([bn(),Un("design:type",Function),Un("design:paramtypes",[]),Un("design:returntype",String)],qn.prototype,"toUrl",null);var Vn=function(e,t){return Vn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},Vn(e,t)};function Jn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Vn(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function Gn(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function Kn(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Wn(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function Yn(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function Zn(e){return this instanceof Zn?(this.v=e,this):new Zn(e)}function Xn(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof Zn?Promise.resolve(r.value.v).then(c,u):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function Qn(e){return"function"==typeof e}function eo(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}Object.create,Object.create;var to=eo((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function ro(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var no=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,r,n,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var a=Kn(i),s=a.next();!s.done;s=a.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(Qn(c))try{c()}catch(e){o=e instanceof to?e.errors:[e]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var l=Kn(u),f=l.next();!f.done;f=l.next()){var h=f.value;try{ao(h)}catch(e){o=null!=o?o:[],e instanceof to?o=Yn(Yn([],Wn(o)),Wn(e.errors)):o.push(e)}}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}if(o)throw new to(o)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)ao(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&ro(t,e)},e.prototype.remove=function(t){var r=this._finalizers;r&&ro(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e;var t}(),oo=no.EMPTY;function io(e){return e instanceof no||e&&"closed"in e&&Qn(e.remove)&&Qn(e.add)&&Qn(e.unsubscribe)}function ao(e){Qn(e)?e():e.unsubscribe()}var so=null,co=null,uo=void 0,lo=!1,fo=!1,ho={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=ho.delegate;return(null==o?void 0:o.setTimeout)?o.setTimeout.apply(o,Yn([e,t],Wn(r))):setTimeout.apply(void 0,Yn([e,t],Wn(r)))},clearTimeout:function(e){var t=ho.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function po(e){ho.setTimeout((function(){if(!so)throw e;so(e)}))}function yo(){}var mo=wo("C",void 0,void 0);function wo(e,t,r){return{kind:e,value:t,error:r}}var bo=null;function vo(e){if(lo){var t=!bo;if(t&&(bo={errorThrown:!1,error:null}),e(),t){var r=bo,n=r.errorThrown,o=r.error;if(bo=null,n)throw o}}else e()}var go=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,io(t)&&t.add(r)):r.destination=Oo,r}return Jn(t,e),t.create=function(e,t,r){return new Ao(e,t,r)},t.prototype.next=function(e){this.isStopped?xo(function(e){return wo("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?xo(wo("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?xo(mo,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(no),Eo=Function.prototype.bind;function _o(e,t){return Eo.call(e,t)}var So=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){Io(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){Io(e)}else Io(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){Io(e)}},e}(),Ao=function(e){function t(t,r,n){var o,i,a=e.call(this)||this;return Qn(t)||!t?o={next:null!=t?t:void 0,error:null!=r?r:void 0,complete:null!=n?n:void 0}:a&&fo?((i=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},o={next:t.next&&_o(t.next,i),error:t.error&&_o(t.error,i),complete:t.complete&&_o(t.complete,i)}):o=t,a.destination=new So(o),a}return Jn(t,e),t}(go);function Io(e){var t;lo?(t=e,lo&&bo&&(bo.errorThrown=!0,bo.error=t)):po(e)}function xo(e,t){var r=co;r&&ho.setTimeout((function(){return r(e,t)}))}var Oo={closed:!0,next:yo,error:function(e){throw e},complete:yo},ko="function"==typeof Symbol&&Symbol.observable||"@@observable";function Co(e){return e}function jo(e){return 0===e.length?Co:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Do,To,Po,Ro,No=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n,o=this,i=(n=e)&&n instanceof go||function(e){return e&&Qn(e.next)&&Qn(e.error)&&Qn(e.complete)}(n)&&io(n)?e:new Ao(e,t,r);return vo((function(){var e=o,t=e.operator,r=e.source;i.add(t?t.call(i,r):r?o._subscribe(i):o._trySubscribe(i))})),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=Bo(t))((function(t,n){var o=new Ao({next:function(t){try{e(t)}catch(e){n(e),o.unsubscribe()}},error:n,complete:t});r.subscribe(o)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[ko]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return jo(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Bo(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function Bo(e){var t;return null!==(t=null!=e?e:uo)&&void 0!==t?t:Promise}!function(e){e[e.GENESIS=0]="GENESIS",e[e.PARTIAL=1]="PARTIAL",e[e.SIGNED=2]="SIGNED"}(Do||(Do={})),function(e){e[e.NOT_REQUESTED=0]="NOT_REQUESTED",e[e.PENDING=1]="PENDING",e[e.PROCESSING=2]="PROCESSING",e[e.ANCHORED=3]="ANCHORED",e[e.FAILED=4]="FAILED"}(To||(To={})),function(e){e[e.GENESIS=0]="GENESIS",e[e.SIGNED=1]="SIGNED",e[e.ANCHOR=2]="ANCHOR"}(Po||(Po={}));class Uo extends No{constructor(e,t){super((t=>{e.subscribe(t)})),this.state$=e,this._context=t}get id(){return new Tn(this.state$.value.type,this.state$.value.log[0].cid)}get api(){return this._context.api}get metadata(){const{next:e,metadata:t}=this.state$.value;return cn(e?.metadata??t)}get content(){const{next:e,content:t}=this.state$.value;return cn(e?.content??t)}get controllers(){return this.metadata.controllers}get tip(){return this.state$.value.log[this.state$.value.log.length-1].cid}get commitId(){return qn.make(this.id,this.tip)}get allCommitIds(){return this.state$.value.log.map((({cid:e})=>qn.make(this.id,e)))}get anchorCommitIds(){return this.state$.value.log.filter((({type:e})=>e===Po.ANCHOR)).map((({cid:e})=>qn.make(this.id,e)))}get state(){return cn(this.state$.value)}async sync(e={}){e={sync:an.PREFER_CACHE,...e};const t=await this.api.loadStream(this.id,e);this.state$.next(t.state)}async requestAnchor(){return this.api.requestAnchor(this.id)}}!function(e){e.from=function(e){if(Tn.isInstance(e))return e;if(qn.isInstance(e))return e;if(e instanceof Uint8Array){const t=qn.fromBytesNoThrow(e);return t instanceof Error?Tn.fromBytes(e):t}if("string"==typeof e){const t=qn.fromStringNoThrow(e);return t instanceof Error?Tn.fromString(e):t}throw new Error("Can not build CommitID or StreamID")}}(Ro||(Ro={}));var Mo;const Lo={anchor:!0,publish:!0,pin:!0,sync:an.PREFER_CACHE},Fo={sync:an.PREFER_CACHE},$o={anchor:!0,publish:!0,throwOnInvalidCommit:!0};function zo(e,t){if("string"==typeof e?.schema)try{qn.fromString(e.schema)}catch{throw new Error("Schema must be a CommitID")}const r={controllers:e?.controllers,family:e?.family,schema:e?.schema?.toString(),tags:e?.tags};if(t)e?.deterministic||(r.unique=on((0,sn.randomBytes)(12),"base64")),e?.forbidControllerChange&&(r.forbidControllerChange=!0);else{if(void 0!==e?.deterministic||void 0!==e?.unique)throw new Error("Cannot change 'deterministic' or 'unique' properties on existing Streams");if(void 0!==e?.forbidControllerChange)throw new Error("Cannot change 'forbidControllerChange' property on existing Streams")}return Object.keys(r).forEach((e=>void 0===r[e]&&delete r[e])),r}async function Ho(e){if(null==e.did)throw new Error("No DID provided");e.did.authenticated||(await e.did.authenticate(),e.loggerProvider&&e.loggerProvider.getDiagnosticsLogger().imp(`Now authenticated as DID ${e.did.id}`))}async function qo(e,t){return await Ho(e),e.did.createDagJWS(t)}async function Vo(){throw new Error("Historical stream commits cannot be modified. Load the stream without specifying a commit to make updates.")}let Jo=Mo=class extends Uo{constructor(){super(...arguments),this._isReadOnly=!1}get content(){return super.content}static async create(e,t,r,n={}){n={...Lo,...n},r?.deterministic||null!=n.syncTimeoutSeconds||(n.syncTimeoutSeconds=0);const o=n.asDID?{did:n.asDID}:e,i=await Mo.makeGenesis(o,t,r);return e.createStreamFromGenesis(Mo.STREAM_TYPE_ID,i,n)}static async createFromGenesis(e,t,r={}){r={...Lo,...r},t.header?.unique&&null==r.syncTimeoutSeconds&&(r.syncTimeoutSeconds=0);const n=t.data?await qo(e,t):t;return e.createStreamFromGenesis(Mo.STREAM_TYPE_ID,n,r)}static async deterministic(e,t,r={}){if(r={...Lo,...r},null==(t={...t,deterministic:!0}).family&&null==t.tags)throw new Error("Family and/or tags are required when creating a deterministic tile document");const n=await Mo.makeGenesis(e,null,t);return e.createStreamFromGenesis(Mo.STREAM_TYPE_ID,n,r)}static async load(e,t,r={}){r={...Fo,...r};const n=Ro.from(t);if(n.type!=Mo.STREAM_TYPE_ID)throw new Error(`StreamID ${n.toString()} does not refer to a '${Mo.STREAM_TYPE_NAME}' stream, but to a ${n.typeName}`);return e.loadStream(n,r)}async update(e,t,r={}){const n=(r={...$o,...r}).asDID?{did:r.asDID}:this.api,o=await this.makeCommit(n,e,t),i=await this.api.applyCommit(this.id,o,r);this.state$.next(i.state)}async patch(e,t={}){t={...$o,...t};const r={header:zo(this.metadata,!1),data:e,prev:this.tip,id:this.state$.id.cid},n=await qo(this.api,r),o=await this.api.applyCommit(this.id,n,t);this.state$.next(o.state)}makeReadOnly(){this.update=Vo,this.patch=Vo,this.sync=Vo,this._isReadOnly=!0}get isReadOnly(){return this._isReadOnly}async makeCommit(e,t,r){const n=zo(r,!1);if(null==t&&(t=this.content),n.controllers&&1!==n.controllers?.length)throw new Error("Exactly one controller must be specified");return qo(e,{header:n,data:Q.compare(this.content,t),prev:this.tip,id:this.state.log[0].cid})}static async makeGenesis(e,t,r){if(r||(r={}),!r.controllers||0===r.controllers.length){if(!e.did)throw new Error("No controllers specified");await Ho(e),r.controllers=[e.did.id]}if(1!==r.controllers?.length)throw new Error("Exactly one controller must be specified");const n=zo(r,!0);if(r?.deterministic&&t)throw new Error("Initial content must be null when creating a deterministic Tile document");if(null==t){const e={header:n};return gr(e),e}return qo(e,{data:t,header:n})}};Jo.STREAM_TYPE_NAME="tile",Jo.STREAM_TYPE_ID=0,Jo=Mo=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}([e=>{}],Jo);var Go=r(98);const Ko=new(r(230).LRUMap)(100),Wo={dag:{get:async e=>(async e=>{const t=Ko.get(e);if(t)return t;const r=await Go(e);if(r.ok){const t=await r.json();return Ko.set(e,t),t}throw new Error("Not a valid 3ID")})((e=>`https://ipfs.3box.io/did-doc?cid=${encodeURIComponent(e)}`)(e))}},Yo=(e,t)=>{const r=new Uint8Array(e.length+2);return r[0]=t?236:231,r[1]=1,r.set(e,2),`z${on(r,"base58btc")}`},Zo=e=>({didResolutionMetadata:e,didDocument:null,didDocumentMetadata:{}}),Xo="application/did+ld+json",Qo="application/did+json",ei=e=>new Date(1e3*e).toISOString().split(".")[0]+"Z";function ti(e,t){if(!e||!e.publicKeys)return null;const r={id:t,verificationMethod:[],authentication:[],keyAgreement:[]};return Object.entries(e.publicKeys).reduce(((e,[r,n])=>{const o=nn(n.slice(1),"base58btc"),i={id:`${t}#${r}`,type:"",controller:t,publicKeyBase58:on(o.slice(2),"base58btc")};return 231===o[0]?(i.type="EcdsaSecp256k1Signature2019",e.verificationMethod.push(i),e.authentication.push(i)):236===o[0]&&(i.type="X25519KeyAgreementKey2019",e.verificationMethod.push(i),e.keyAgreement.push(i)),e}),r)}const ri=async(e,t,r,n)=>{const o=Tn.fromString(t);let i;const a=[{streamId:o}];r.commit?(i=qn.make(o,r.commit),a.push({streamId:i})):r.timestamp&&a.push({streamId:o,atTime:r.timestamp});const s=await e.multiQuery(a),c=s[t].state,u=i?.toString()||Object.keys(s).find((e=>e!==t)),l=function(e,t){const r={},{timestamp:n,cid:o}=function(e){for(let t=e.length-1;t>=0;t--){const r=e[t];if(r.type===Po.ANCHOR)return r}return e[0]}(e.log),{timestamp:i,cid:a}=t.log.find((({timestamp:e})=>e>n||!n&&e))||{};return n&&(r.updated=ei(n)),i&&(r.nextUpdate=ei(i)),o&&(r.versionId=1===e.log.length?"0":o?.toString()),a&&(r.nextVersionId=a.toString()),r}(s[u]?.state||c,c),f=s[u||t];if(u&&!f)throw new Error(`No resolution for commit ${u}`);const h=ti(f.state.content,`did:3:${n||t}`);return{didResolutionMetadata:{contentType:Qo},didDocument:h,didDocumentMetadata:l}};function ni(e){return{3:(t,r,n,o)=>(async()=>{const t=o.accept||Qo,n=function(e=""){const t=e.split("&").find((e=>e.includes("versionId")||e.includes("version-id"))),r=e.split("&").find((e=>e.includes("versionTime")));return{commit:t?t.split("=")[1]:void 0,timestamp:r?Math.floor(new Date(r.split("=")[1]).getTime()/1e3):void 0}}(r.query),i=r.id,a=()=>(e=>{try{return or.parse(e),!0}catch(e){return!1}})(i)?(async(e,t,r)=>{const n=await(async(e,t=Wo)=>{const r=(await t.dag.get(e)).value;let n,o;try{const e=r.publicKey.findIndex((e=>e.id.endsWith("signingKey"))),t=r.publicKey.findIndex((e=>e.id.endsWith("encryptionKey")));n=r.publicKey[e].publicKeyHex,o=r.publicKey[t].publicKeyBase64}catch(e){throw new Error("Not a valid 3ID")}const i=(e=>{const t=e.slice(2,66);return`${0==(1&e.slice(66,130))?"02":"03"}${t}`})(n),a=Yo(nn(i,"base16")),s=Yo(nn(o,"base64pad"),!0);return{keyDid:`did:key:${a}`,publicKeys:{[a.slice(-15)]:a,[s.slice(-15)]:s}}})(t),o={controllers:[n.keyDid],family:"3id",deterministic:!0},i=(await Jo.create(e,null,o,{anchor:!1,publish:!1})).id,a=await ri(e,i.toString(),r,t);return null===a.didDocument&&(a.didDocument=ti(n,`did:3:${t}`)),a})(e,i,n):ri(e,i,n);switch(t){case Qo:return a();case Xo:{const e=await a();return e.didDocument["@context"]="https://www.w3.org/ns/did/v1",e.didResolutionMetadata.contentType=Xo,e}default:return Zo({error:"representationNotSupported"})}})().catch((e=>Zo({error:"invalidDid",message:e.toString()})))}}function oi(e){return"string"==typeof e?Tn.fromString(e):e}var ii=function(e){function t(t,r){return e.call(this)||this}return Jn(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(no),ai={setInterval:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=ai.delegate;return(null==o?void 0:o.setInterval)?o.setInterval.apply(o,Yn([e,t],Wn(r))):setInterval.apply(void 0,Yn([e,t],Wn(r)))},clearInterval:function(e){var t=ai.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},si=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n.pending=!1,n}return Jn(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this},t.prototype.requestAsyncId=function(e,t,r){return void 0===r&&(r=0),ai.setInterval(e.flush.bind(e,this),r)},t.prototype.recycleAsyncId=function(e,t,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return t;ai.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var r,n=!1;try{this.work(e)}catch(e){n=!0,r=e||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,ro(n,this),null!=t&&(this.id=this.recycleAsyncId(r,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(ii),ci={now:function(){return(ci.delegate||Date).now()},delegate:void 0},ui=function(){function e(t,r){void 0===r&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(e,t,r){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(r,t)},e.now=ci.now,e}(),li=new(function(e){function t(t,r){void 0===r&&(r=ui.now);var n=e.call(this,t,r)||this;return n.actions=[],n._active=!1,n._scheduled=void 0,n}return Jn(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}},t}(ui))(si);function fi(e){return e&&Qn(e.schedule)}function hi(e,t,r){void 0===e&&(e=0),void 0===r&&(r=li);var n=-1;return null!=t&&(fi(t)?r=t:n=t),new No((function(t){var o,i=(o=e)instanceof Date&&!isNaN(o)?+e-r.now():e;i<0&&(i=0);var a=0;return r.schedule((function(){t.closed||(t.next(a++),0<=n?this.schedule(void 0,n):t.complete())}),i)}))}function di(e){return function(t){if(function(e){return Qn(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}function pi(e,t,r,n,o){return new yi(e,t,r,n,o)}var yi=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t)||this;return s.onFinalize=i,s.shouldUnsubscribe=a,s._next=r?function(e){try{r(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=o?function(e){try{o(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=n?function(){try{n()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return Jn(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(go),mi=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function wi(e){return Qn(null==e?void 0:e.then)}function bi(e){return Qn(e[ko])}function vi(e){return Symbol.asyncIterator&&Qn(null==e?void 0:e[Symbol.asyncIterator])}function gi(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Ei="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function _i(e){return Qn(null==e?void 0:e[Ei])}function Si(e){return Xn(this,arguments,(function(){var t,r,n;return Gn(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,Zn(t.read())];case 3:return r=o.sent(),n=r.value,r.done?[4,Zn(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,Zn(n)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function Ai(e){return Qn(null==e?void 0:e.getReader)}function Ii(e){if(e instanceof No)return e;if(null!=e){if(bi(e))return o=e,new No((function(e){var t=o[ko]();if(Qn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(mi(e))return n=e,new No((function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()}));if(wi(e))return r=e,new No((function(e){r.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,po)}));if(vi(e))return xi(e);if(_i(e))return t=e,new No((function(e){var r,n;try{for(var o=Kn(t),i=o.next();!i.done;i=o.next()){var a=i.value;if(e.next(a),e.closed)return}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}e.complete()}));if(Ai(e))return xi(Si(e))}var t,r,n,o;throw gi(e)}function xi(e){return new No((function(t){(function(e,t){var r,n,o,i,a,s,c,u;return a=this,s=void 0,u=function(){var a,s;return Gn(this,(function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),r=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=Kn(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}}(e),c.label=1;case 1:return[4,r.next()];case 2:if((n=c.sent()).done)return[3,4];if(a=n.value,t.next(a),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=c.sent(),o={error:s},[3,11];case 6:return c.trys.push([6,,9,10]),n&&!n.done&&(i=r.return)?[4,i.call(r)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))},new((c=void 0)||(c=Promise))((function(e,t){function r(e){try{o(u.next(e))}catch(e){t(e)}}function n(e){try{o(u.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof c?o:new c((function(e){e(o)}))).then(r,n)}o((u=u.apply(a,s||[])).next())}))})(e,t).catch((function(e){return t.error(e)}))}))}var Oi={leading:!0,trailing:!1},ki=eo((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),Ci=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return Jn(t,e),t.prototype.lift=function(e){var t=new ji(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new ki},t.prototype.next=function(e){var t=this;vo((function(){var r,n;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var o=Kn(t.currentObservers),i=o.next();!i.done;i=o.next())i.value.next(e)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}}))},t.prototype.error=function(e){var t=this;vo((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}}))},t.prototype.complete=function(){var e=this;vo((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=this,n=r.hasError,o=r.isStopped,i=r.observers;return n||o?oo:(this.currentObservers=null,i.push(e),new no((function(){t.currentObservers=null,ro(i,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,r=t.hasError,n=t.thrownError,o=t.isStopped;r?e.error(n):o&&e.complete()},t.prototype.asObservable=function(){var e=new No;return e.source=this,e},t.create=function(e,t){return new ji(e,t)},t}(No),ji=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return Jn(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:oo},t}(Ci),Di=function(e){function t(t){var r=e.call(this)||this;return r._value=t,r}return Jn(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var r=e.prototype._subscribe.call(this,t);return!r.closed&&t.next(this._value),r},t.prototype.getValue=function(){var e=this,t=e.hasError,r=e.thrownError,n=e._value;if(t)throw r;return this._throwIfClosed(),n},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(Ci);function Ti(e){const t=or.asCID(e);if(t)return t;if("string"==typeof e)return or.parse(e);if(e instanceof Uint8Array)return or.decode(e);throw new Error(`${e} cannot be converted to a CID`)}class Pi{static streamIdFromState(e){return new Tn(e.type,e.log[0].cid)}static serializeCommit(e){const t=cn(e);return Pi.isSignedCommitContainer(t)?(t.jws.link=t.jws.link.toString(),t.linkedBlock=on(t.linkedBlock,"base64"),t.cacaoBlock&&(t.cacaoBlock=on(t.cacaoBlock,"base64")),t):(Pi.isSignedCommit(e)&&(t.link=t.link.toString()),Pi.isAnchorCommit(e)&&(t.proof=t.proof.toString()),t.id&&(t.id=t.id.toString()),t.prev&&(t.prev=t.prev.toString()),t)}static deserializeCommit(e){const t=cn(e);return Pi.isSignedCommitContainer(t)?(t.jws.link=Ti(t.jws.link),t.linkedBlock=nn(t.linkedBlock,"base64"),t.cacaoBlock&&(t.cacaoBlock=nn(t.cacaoBlock,"base64")),t):(Pi.isSignedCommit(t)&&(t.link=Ti(t.link)),Pi.isAnchorCommit(t)&&(t.proof=Ti(t.proof)),t.id&&(t.id=Ti(t.id)),t.prev&&(t.prev=Ti(t.prev)),t)}static serializeState(e){const t=cn(e);return t.log=t.log.map((e=>({...e,cid:e.cid.toString()}))),null!=t.anchorStatus&&(t.anchorStatus=To[t.anchorStatus]),null!=t.anchorScheduledFor&&(t.anchorScheduledFor=new Date(t.anchorScheduledFor).toISOString()),null!=t.anchorProof&&(t.anchorProof.txHash=t.anchorProof.txHash.toString(),t.anchorProof.root=t.anchorProof.root.toString()),null!=t.lastAnchored&&(t.lastAnchored=t.lastAnchored.toString()),t.doctype=_n.nameByCode(t.type),t}static deserializeState(e){const t=cn(e);t.doctype&&(t.type=_n.codeByName(t.doctype),delete t.doctype),t.log=t.log.map((e=>({...e,cid:Ti(e.cid)}))),t.anchorProof&&(t.anchorProof.txHash=Ti(t.anchorProof.txHash),t.anchorProof.root=Ti(t.anchorProof.root));let r=!0;return t.anchorStatus&&(t.anchorStatus=To[t.anchorStatus],r=t.anchorStatus!==To.FAILED&&t.anchorStatus!==To.ANCHORED),t.anchorScheduledFor&&(r?t.anchorScheduledFor=Date.parse(t.anchorScheduledFor):delete t.anchorScheduledFor),t.lastAnchored&&(t.lastAnchored=Ti(t.lastAnchored)),t}static statesEqual(e,t){return JSON.stringify(Pi.serializeState(e))===JSON.stringify(Pi.serializeState(t))}static isStateSupersetOf(e,t){if(e.log.length<t.log.length)return!1;for(const r in t.log)if(!e.log[r].cid.equals(t.log[r].cid))return!1;return e.anchorStatus==t.anchorStatus}static async convertCommitToSignedCommitContainer(e,t){return Pi.isSignedCommit(e)?{jws:e,linkedBlock:await t.block.get(e.link)}:e}static isSignedCommitContainer(e){return e&&void 0!==e.jws}static isSignedCommit(e){return e&&void 0!==e.link}static isAnchorCommit(e){return e&&void 0!==e.proof}static isSignedCommitData(e){return e&&void 0!==e.envelope}static isAnchorCommitData(e){return e&&void 0!==e.proof}}class Ri extends Di{next(e){const t=this.value;Pi.statesEqual(t,e)||super.next(e)}}function Ni(e,t){return di((function(r,n){var o=0;r.subscribe(pi(n,(function(r){n.next(e.call(t,r,o++))})))}))}function Bi(e,t,r,n,o){void 0===n&&(n=0),void 0===o&&(o=!1);var i=t.schedule((function(){r(),o?e.add(this.schedule(null,n)):this.unsubscribe()}),n);if(e.add(i),!o)return i}function Ui(e,t,r){return void 0===r&&(r=1/0),Qn(t)?Ui((function(r,n){return Ni((function(e,o){return t(r,e,n,o)}))(Ii(e(r,n)))}),r):("number"==typeof t&&(r=t),di((function(t,n){return function(e,t,r,n,o,i,a,s){var c=[],u=0,l=0,f=!1,h=function(){!f||c.length||u||t.complete()},d=function(e){return u<n?p(e):c.push(e)},p=function(e){u++;var o=!1;Ii(r(e,l++)).subscribe(pi(t,(function(e){t.next(e)}),(function(){o=!0}),void 0,(function(){if(o)try{u--;for(;c.length&&u<n;)e=void 0,e=c.shift(),p(e);h()}catch(e){t.error(e)}var e})))};return e.subscribe(pi(t,d,(function(){f=!0,h()}))),function(){}}(t,n,e,r)})))}function Mi(e){return void 0===e&&(e=1/0),Ui(Co,e)}var Li=new No((function(e){return e.complete()}));function Fi(e){return e[e.length-1]}function $i(e){return fi(Fi(e))?e.pop():void 0}function zi(e,t){return"number"==typeof Fi(e)?e.pop():t}function Hi(e,t){return void 0===t&&(t=0),di((function(r,n){r.subscribe(pi(n,(function(r){return Bi(n,e,(function(){return n.next(r)}),t)}),(function(){return Bi(n,e,(function(){return n.complete()}),t)}),(function(r){return Bi(n,e,(function(){return n.error(r)}),t)})))}))}function qi(e,t){return void 0===t&&(t=0),di((function(r,n){n.add(e.schedule((function(){return r.subscribe(n)}),t))}))}function Vi(e,t){if(!e)throw new Error("Iterable cannot be null");return new No((function(r){Bi(r,t,(function(){var n=e[Symbol.asyncIterator]();Bi(r,t,(function(){n.next().then((function(e){e.done?r.complete():r.next(e.value)}))}),0,!0)}))}))}function Ji(e,t){return t?function(e,t){if(null!=e){if(bi(e))return function(e,t){return Ii(e).pipe(qi(t),Hi(t))}(e,t);if(mi(e))return function(e,t){return new No((function(r){var n=0;return t.schedule((function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())}))}))}(e,t);if(wi(e))return function(e,t){return Ii(e).pipe(qi(t),Hi(t))}(e,t);if(vi(e))return Vi(e,t);if(_i(e))return function(e,t){return new No((function(r){var n;return Bi(r,t,(function(){n=e[Ei](),Bi(r,t,(function(){var e,t,o;try{t=(e=n.next()).value,o=e.done}catch(e){return void r.error(e)}o?r.complete():r.next(t)}),0,!0)})),function(){return Qn(null==n?void 0:n.return)&&n.return()}}))}(e,t);if(Ai(e))return function(e,t){return Vi(Si(e),t)}(e,t)}throw gi(e)}(e,t):Ii(e)}var Gi=Array.isArray;var Ki=["addListener","removeListener"],Wi=["addEventListener","removeEventListener"],Yi=["on","off"];function Zi(e,t,r,n){if(Qn(r)&&(n=r,r=void 0),n)return Zi(e,t,r).pipe((o=n,Ni((function(e){return function(e,t){return Gi(t)?e.apply(void 0,Yn([],Wn(t))):e(t)}(o,e)}))));var o,i=Wn(function(e){return Qn(e.addEventListener)&&Qn(e.removeEventListener)}(e)?Wi.map((function(n){return function(o){return e[n](t,o,r)}})):function(e){return Qn(e.addListener)&&Qn(e.removeListener)}(e)?Ki.map(Xi(e,t)):function(e){return Qn(e.on)&&Qn(e.off)}(e)?Yi.map(Xi(e,t)):[],2),a=i[0],s=i[1];if(!a&&mi(e))return Ui((function(e){return Zi(e,t,r)}))(Ii(e));if(!a)throw new TypeError("Invalid event target");return new No((function(e){var t=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.next(1<t.length?t:t[0])};return a(t),function(){return s(t)}}))}function Xi(e,t){return function(r){return function(n){return e[r](t,n)}}}var Qi=eo((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}));function ea(e,t){return di((function(r,n){var o=0;r.subscribe(pi(n,(function(r){return e.call(t,r,o++)&&n.next(r)})))}))}function ta(e){return e<=0?function(){return Li}:di((function(t,r){var n=0;t.subscribe(pi(r,(function(t){++n<=e&&(r.next(t),e<=n&&r.complete())})))}))}function ra(e){return di((function(t,r){var n=!1;t.subscribe(pi(r,(function(e){n=!0,r.next(e)}),(function(){n||r.next(e),r.complete()})))}))}function na(e){return void 0===e&&(e=oa),di((function(t,r){var n=!1;t.subscribe(pi(r,(function(e){n=!0,r.next(e)}),(function(){return n?r.complete():r.error(e())})))}))}function oa(){return new Qi}var ia=r(599);globalThis.AbortController||(globalThis.AbortController=ia.AbortController),globalThis.AbortSignal||(globalThis.AbortSignal=ia.AbortSignal);class aa{constructor(e){const t=new AbortController;this.signal=t.signal,e<=0?t.abort():this._subscription=hi(e).subscribe((()=>{t.abort()}))}clear(){this._subscription?.unsubscribe()}}async function sa(e,t={}){t.body&&Object.assign(t,{body:JSON.stringify(t.body),headers:{"Content-Type":"application/json"}});const r=t.timeout||18e4,n=new aa(r);t.signal=t.signal?function(e){const t=new AbortController;if(0===e.length)throw Error("Need abort signals to create a merged abort signal");return e.some((e=>e.aborted))?(t.abort(),t.signal):(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=$i(e),n=zi(e,1/0),o=e;return o.length?1===o.length?Ii(o[0]):Mi(n)(Ji(o,r)):Li}(...e.map((e=>Zi(e,"abort")))).pipe(function(e,t){var r=arguments.length>=2;return function(n){return n.pipe(e?ea((function(t,r){return e(t,r,n)})):Co,ta(1),r?ra(t):na((function(){return new Qi})))}}()).subscribe((()=>{t.abort()})),t.signal)}([t.signal,n.signal]):n.signal;const o=await Go(e,t).finally((()=>n.clear()));if(!o.ok){const t=await o.text();throw new Error(`HTTP request to '${e}' failed with status '${o.statusText}': ${t}`)}return o.json()}var ca=r(563);class ua extends No{constructor(e,t,r){super((e=>{0===this.state$.observers.length&&(this.periodicSubscription=hi(0,r).pipe(function(e,t){return void 0===t&&(t=Oi),di((function(r,n){var o=t.leading,i=t.trailing,a=!1,s=null,c=null,u=!1,l=function(){null==c||c.unsubscribe(),c=null,i&&(d(),u&&n.complete())},f=function(){c=null,u&&n.complete()},h=function(t){return c=Ii(e()).subscribe(pi(n,l,f))},d=function(){if(a){a=!1;var e=s;s=null,n.next(e),!u&&h()}};r.subscribe(pi(n,(function(e){a=!0,s=e,(!c||c.closed)&&(o?d():h())}),(function(){u=!0,(!(i&&a&&c)||c.closed)&&n.complete()})))}))}((()=>this._syncState(this.id,{sync:an.PREFER_CACHE})))).subscribe()),this.state$.subscribe(e).add((()=>{0===this.state$.observers.length&&this.periodicSubscription?.unsubscribe()}))})),this._apiUrl=t,this.state$=new Ri(e)}get value(){return this.state$.value}get state(){return this.state$.value}next(e){this.state$.next(e)}async _syncState(e,t){const r=await ua._load(e,this._apiUrl,t);this.state$.next(Pi.deserializeState(r))}get id(){return new Tn(this.state$.value.type,this.state$.value.log[0].cid)}static async createFromGenesis(e,t,r,n,o){const{state:i}=await sa(e+"/streams",{method:"post",body:{type:t,genesis:Pi.serializeCommit(r),opts:n}});return new ua(Pi.deserializeState(i),e,o)}static async applyCommit(e,t,r,n,o){const{state:i}=await sa(e+"/commits",{method:"post",body:{streamId:t.toString(),commit:Pi.serializeCommit(r),opts:n}});return new ua(Pi.deserializeState(i),e,o)}static async _load(e,t,r){const n=t+"/streams/"+e.toString()+"?"+ca.stringify(r),{state:o}=await sa(n);return o}static async load(e,t,r,n){const o=await ua._load(e,t,n);return new ua(Pi.deserializeState(o),t,r)}static async loadStreamCommits(e,t){const{commits:r}=await sa(`${t}/commits/${e}`);return r.map((e=>({cid:e.cid,value:Pi.deserializeCommit(e.value)})))}complete(){this.state$.complete()}}function la(e,t){return t()}const fa="(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))",ha="[a-zA-Z0-9_.:%-]",da=new RegExp(`^did:([a-z0-9]+):((?:${fa}*:)*(${fa}+))((;${ha}+=${ha}*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$`);function pa(e){if(""===e||!e)return null;const t=e.match(da);if(t){const r={did:`did:${t[1]}:${t[2]}`,method:t[1],id:t[2],didUrl:e};if(t[4]){const e=t[4].slice(1).split(";");r.params={};for(const t of e){const e=t.split("=");r.params[e[0]]=e[1]}}return t[6]&&(r.path=t[6]),t[7]&&(r.query=t[7].slice(1)),t[8]&&(r.fragment=t[8].slice(1)),r}return null}const ya={didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};class ma{constructor(e={},t={}){this.registry=void 0,this.cache=void 0,this.registry=e,this.cache=!0===t.cache?function(){const e=new Map;return function(t,r){try{let n;function o(o){if(n)return o;const i=e.get(t.didUrl);return void 0!==i?i:Promise.resolve(r()).then((function(r){var n;return"notFound"!==(null==(n=r.didResolutionMetadata)?void 0:n.error)&&e.set(t.didUrl,r),r}))}const i=function(){if(t.params&&"true"===t.params["no-cache"])return n=1,Promise.resolve(r())}();return Promise.resolve(i&&i.then?i.then(o):o(i))}catch(a){return Promise.reject(a)}}}():t.cache||la,t.legacyResolvers&&Object.keys(t.legacyResolvers).map((e=>{this.registry[e]||(this.registry[e]=function(e){return function(t,r,n){try{return Promise.resolve(function(o,i){try{var a=Promise.resolve(e(t,r,n)).then((function(e){return{...ya,didResolutionMetadata:{contentType:"application/did+ld+json"},didDocument:e}}))}catch(e){return i(e)}return a&&a.then?a.then(void 0,i):a}(0,(function(e){return{...ya,didResolutionMetadata:{error:"notFound",message:e.toString()}}})))}catch(e){return Promise.reject(e)}}}(t.legacyResolvers[e]))}))}resolve(e,t={}){try{const r=this,n=pa(e);if(null===n)return Promise.resolve({...ya,didResolutionMetadata:{error:"invalidDid"}});const o=r.registry[n.method];return o?Promise.resolve(r.cache(n,(()=>o(n.did,n,r,t)))):Promise.resolve({...ya,didResolutionMetadata:{error:"unsupportedDidMethod"}})}catch(e){return Promise.reject(e)}}}var wa,ba=r(872);const va=()=>{throw new Error("Historical stream commits cannot be modified. Load the stream without specifying a commit to make updates.")},ga={anchor:!1,publish:!0,pin:!0,sync:an.PREFER_CACHE},Ea={anchor:!0,publish:!0,throwOnInvalidCommit:!0},_a={sync:an.PREFER_CACHE};let Sa=wa=class extends Uo{constructor(){super(...arguments),this._isReadOnly=!1}get did(){return this.content}static async fromAccount(e,t,r={}){r={...ga,...r};const n=function(e){if("string"==typeof e&&e.includes("@")){const[t,r]=e.split("@");if(!t||!r)throw new Error("Invalid accountId provided");return new ba.AccountId({address:t,chainId:r})}return new ba.AccountId(e)}(t),o=wa.makeGenesis(n);return wa.fromGenesis(e,o,r)}static async fromGenesis(e,t,r={}){return r={...ga,...r},e.createStreamFromGenesis(wa.STREAM_TYPE_ID,t,r)}async setDid(e,t,r={}){r={...Ea,...r};const n="string"==typeof e?e.trim():e.id;if(pa(n)?.did!==n)throw new Error(`DID is not valid: '${n}'`);const o=await t.createLink(n);return this.setDidProof(o,r)}async setDidProof(e,t={}){t={...Ea,...t};const r=this.makeCommit(e),n=await this.api.applyCommit(this.id,r,t);this.state$.next(n.state)}async clearDid(e,t={}){t={...Ea,...t};const r=await e.createLink("");return this.setDidProof(r,t)}static async load(e,t,r={}){r={..._a,...r};const n=Ro.from(t);if(n.type!=wa.STREAM_TYPE_ID)throw new Error(`StreamID ${n.toString()} does not refer to a '${wa.STREAM_TYPE_NAME}' stream, but to a ${n.typeName}`);return e.loadStream(n,r)}static makeGenesis(e){return"eip155"===e.chainId.namespace&&(e.address=e.address.toLowerCase()),{header:{controllers:[`${e.address}@${e.chainId.toString()}`],family:`caip10-${e.chainId.toString()}`}}}makeCommit(e){return{data:e,prev:this.tip,id:this.state$.id.cid}}makeReadOnly(){this.setDidProof=va,this.setDid=va,this.sync=va,this._isReadOnly=!0}get isReadOnly(){return this._isReadOnly}};Sa.STREAM_TYPE_NAME="caip10-link",Sa.STREAM_TYPE_ID=1,Sa=wa=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}([e=>{}],Sa);class Aa{constructor(e){this._apiUrl=e}async add(e,t){const r={};t&&(r.force=!0),await sa(this._apiUrl+"/pins"+`/${e.toString()}`,{method:"post",body:r})}async rm(e,t){await sa(this._apiUrl+"/pins"+`/${e.toString()}`,{method:"delete",body:{opts:t}})}async ls(e){let t=this._apiUrl+"/pins";e&&(t+=`/${e.toString()}`);const r=await sa(t),{pinnedStreamIds:n}=r;return{[Symbol.asyncIterator](){let e=0;return{next:()=>e===n.length?Promise.resolve({value:null,done:!0}):Promise.resolve({value:n[e++],done:!1})}}}}}const Ia={syncInterval:5e3},xa={anchor:!0,publish:!0,sync:an.PREFER_CACHE},Oa={anchor:!0,publish:!0,sync:an.PREFER_CACHE},ka={sync:an.PREFER_CACHE};class Ca{constructor(e="http://localhost:7007",t={}){var r;this._config={...Ia,...t},this._apiUrl=(r=e,"/api/v0"?r.replace(/\/+$/,"")+"/"+"/api/v0".replace(/^\/+/,""):r),this._streamCache=new Map,this.context={api:this},this.pin=new Aa(this._apiUrl),this._streamConstructors={[Jo.STREAM_TYPE_ID]:Jo,[Sa.STREAM_TYPE_ID]:Sa}}get did(){return this.context.did}set did(e){this.context.did=e}async createStreamFromGenesis(e,t,r={}){r={...Oa,...r};const n=await ua.createFromGenesis(this._apiUrl,e,t,r,this._config.syncInterval),o=this._streamCache.get(n.id.toString());return o?(Pi.statesEqual(n.state,o.state)||o.next(n.state),this.buildStream(o)):(this._streamCache.set(n.id.toString(),n),this.buildStream(n))}async loadStream(e,t={}){t={...ka,...t};const r=Ro.from(e);let n=this._streamCache.get(r.baseID.toString());return n?await n._syncState(r,t):(n=await ua.load(r,this._apiUrl,this._config.syncInterval,t),this._streamCache.set(n.id.toString(),n)),this.buildStream(n)}async multiQuery(e,t){const r=e.map((e=>({...e,streamId:"string"==typeof e.streamId?e.streamId:e.streamId.toString()}))),n=await sa(this._apiUrl+"/multiqueries",{method:"post",body:{queries:r,timeout:t}});return Object.entries(n).reduce(((e,t)=>{const[r,n]=t,o=Pi.deserializeState(n),i=new ua(o,this._apiUrl,this._config.syncInterval);return e[r]=this.buildStream(i),e}),{})}loadStreamCommits(e){const t=oi(e);return ua.loadStreamCommits(t,this._apiUrl)}async applyCommit(e,t,r={}){r={...xa,...r};const n=oi(e),o=await ua.applyCommit(this._apiUrl,n,t,r,this._config.syncInterval),i=this._streamCache.get(n.toString());return i?(i.next(o.state),this.buildStream(o)):(this._streamCache.set(n.toString(),o),this.buildStream(o))}async requestAnchor(e,t={}){t={...ka,...t};const{anchorStatus:r}=await sa(`${this._apiUrl}/streams/${e.toString()}/anchor`,{method:"post",body:{opts:t}});return r}addStreamHandler(e){this._streamConstructors[e.name]=e.stream_constructor}findStreamConstructor(e){const t=this._streamConstructors[e];if(t)return t;throw new Error(`Failed to find constructor for stream ${e}`)}buildStream(e){return new(this.findStreamConstructor(e.state.type))(e,this.context)}async setDID(e){this.context.did=e}async getSupportedChains(){if(this._supportedChains)return this._supportedChains;const{supportedChains:e}=await sa(this._apiUrl+"/node/chains");return this._supportedChains=e,e}async close(){Array.from(this._streamCache).map((([,e])=>{e.complete()})),this._streamCache.clear()}}var ja=r(933);function Da(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ta(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Da(e,t,"get"))}function Pa(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function Ra(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,Da(e,t,"set"),r),r}function Na(e){return"string"==typeof e||qn.isInstance(e)||Tn.isInstance(e)?{streamId:e}:{streamId:e.streamId,genesis:e.genesis}}function Ba(e){return"string"==typeof e?Ro.from(e).toString():qn.isInstance(e)||Tn.isInstance(e)?e.toString():e.streamId.toString()}async function Ua(e){const t=await Jo.makeGenesis({},null,{...e,deterministic:!0});return{genesis:t,streamId:await Tn.fromGenesis("tile",t)}}const Ma=()=>Promise.resolve([]);var La=new WeakMap,Fa=new WeakMap;class $a extends ja{cache(e){if(!Ta(this,Fa))return!1;const t=e.id.toString();return this.clear(t).prime(t,e),!0}async create(e,t,r){const n=await Jo.create(Ta(this,La),e,t,r);return this.cache(n),n}async deterministic(e,t){const r=await Ua(e);try{return await super.load(r)}catch(e){const n=await Jo.createFromGenesis(Ta(this,La),r.genesis,t);return this.cache(n),n}}async load(e){return await super.load(e)}async update(e,t,r,n){const o=Ba(e);this.clear(o);const i=await this.load({streamId:o});return await i.update(t,r,n),i}constructor(e){super(Ma,{cache:!0,cacheKeyFn:Ba,cacheMap:null!=e.cache&&"boolean"!=typeof e.cache?e.cache:void 0}),Pa(this,La,{writable:!0,value:void 0}),Pa(this,Fa,{writable:!0,value:void 0}),this._batchLoadFn=async t=>{e.cache||this.clearAll();const r=await e.ceramic.multiQuery(t.map(Na),e.multiqueryTimeout);return t.map((e=>{const t=Ba(e);return r[t]||new Error(`Failed to load stream: ${t}`)}))},Ra(this,La,e.ceramic),Ra(this,Fa,!!e.cache)}}function za(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Ha(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,za(e,t,"get"))}function qa(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function Va(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,za(e,t,"set"),r),r}var Ja=new WeakMap,Ga=new WeakMap;class Ka{get aliases(){return Ha(this,Ja)}get loader(){return Ha(this,Ga)}getDefinitionID(e){return Ha(this,Ja).definitions[e]??null}getSchemaURL(e){return Ha(this,Ja).schemas[e]??null}getTileID(e){return Ha(this,Ja).tiles[e]??null}async loadTile(e){const t=this.getTileID(e);if(null==t)throw new Error(`Tile alias "${e}" is not defined`);return await Ha(this,Ga).load(t)}async createTile(e,t,r={}){const n=this.getSchemaURL(e);if(null==n)throw new Error(`Schema alias "${e}" is not defined`);const{controller:o,...i}=r,a={schema:n};return null!=o&&(a.controllers=[o]),await Ha(this,Ga).create(t,a,i)}constructor(e){if(qa(this,Ja,{writable:!0,value:void 0}),qa(this,Ga,{writable:!0,value:void 0}),Va(this,Ja,e.aliases),null!=e.loader)Va(this,Ga,e.loader);else{if(null==e.ceramic)throw new Error("Invalid DataModel parameters: missing ceramic or loader");Va(this,Ga,new $a({ceramic:e.ceramic,cache:e.cache}))}}}const Wa="ceramic://k3y52l7qbv1fryjn62sggjh1lpn11c56qfofzmty190d62hwk1cal1c7qc5he54ow";function Ya(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Za(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Ya(e,t,"get"))}function Xa(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function Qa(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,Ya(e,t,"set"),r),r}var es=new WeakMap,ts=new WeakMap,rs=new WeakMap,ns=new WeakMap;class os{_createValuePromise(){Qa(this,rs,new Promise(((e,t)=>{Qa(this,ns,{resolve:e,reject:t})})))}change(e){return new Promise(((t,r)=>{Za(this,ts).push({reject:r,run:async n=>{try{const r=await e(n);t(),this._next(r)}catch(e){r(e),this._next(n)}}}),1===Za(this,ts).length&&this._start()}))}async changeContent(e){return await this.change((async t=>(await t.update(e(t.content),t.metadata),t)))}async get(){return 0===Za(this,ts).length?await Za(this,es).call(this):await Za(this,rs)}async _start(){try{const e=await Za(this,es).call(this);this._next(e)}catch(e){Za(this,ts).forEach((t=>{t.reject(e)})),Qa(this,ts,[]),Za(this,ns).reject(e),this._createValuePromise()}}_next(e){const t=Za(this,ts).shift();null==t?this._end(e):t.run(e)}_end(e){Za(this,ns).resolve(e),this._createValuePromise()}constructor(e){Xa(this,es,{writable:!0,value:void 0}),Xa(this,ts,{writable:!0,value:[]}),Xa(this,rs,{writable:!0,value:void 0}),Xa(this,ns,{writable:!0,value:void 0}),Qa(this,es,e),this._createValuePromise()}}const is=/^did:([A-Za-z0-9]+):([A-Za-z0-9.\-:_]+)$/;function as(e){return is.test(e)}function ss(e){return function(e){if(!as(e))throw new Error(`Invalid DID: ${e}`)}(e),{controllers:[e],family:"IDX"}}function cs(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function us(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,cs(e,t,"get"))}function ls(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function fs(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,cs(e,t,"set"),r),r}var hs=new WeakMap,ds=new WeakMap,ps=new WeakMap,ys=new WeakMap,ms=new WeakMap;class ws{get authenticated(){return null!=us(this,hs).did}get ceramic(){return us(this,hs)}get id(){if(null!=us(this,ds))return us(this,ds);if(null==us(this,hs).did)throw new Error("Ceramic instance is not authenticated");return us(this,hs).did.hasParent?us(this,hs).did.parent:us(this,hs).did.id}get loader(){return us(this,ys)}get model(){return us(this,ms)}async has(e,t){const r=this.getDefinitionID(e);return null!=await this.getRecordID(r,t)}async get(e,t){const r=this.getDefinitionID(e);return await this.getRecord(r,t)}async getMultiple(e,t){const r=this.getDefinitionID(e),n=await Promise.all(t.map((async e=>{const{genesis:t,streamId:n}=await Ua(ss(e));return{genesis:t,streamId:n.toString(),paths:[r]}}))),o=await us(this,hs).multiQuery(n),i=[];for(const e of n){const t=o[e.streamId]?.content?.[r],n=t?o[Tn.fromString(t).toString()]:null;i.push(n?.content??null)}return i}async set(e,t,r={}){const n=this.getDefinitionID(e),[o,i]=await this._setRecordOnly(n,t,r);return o&&await this._setReference(r.controller??this.id,n,i),i}async merge(e,t,r={}){const n=this.getDefinitionID(e),o=await this.getRecord(n),i=o?{...o,...t}:t;return await this.setRecord(n,i,r)}async setAll(e,t={}){const r=Object.entries(e).map((async([e,r])=>{const n=this.getDefinitionID(e),[o,i]=await this._setRecordOnly(n,r,t);return[o,n,i]})),n=(await Promise.all(r)).reduce(((e,[t,r,n])=>(t&&(e[r]=n.toUrl()),e)),{});return await this._setReferences(t.controller??this.id,n),n}async setDefaults(e,t={}){const r=await this.getIndex()??{},n=Object.entries(e).map((([e,t])=>[this.getDefinitionID(e),t])).filter((e=>null==r[e[0]])).map((async([e,r])=>{const n=await this.getDefinition(e);return{[e]:(await this._createRecord(n,r,t)).toUrl()}})),o=(await Promise.all(n)).reduce(((e,t)=>Object.assign(e,t)),{});return await this._setReferences(t.controller??this.id,o),o}async remove(e,t=this.id){await this._getIndexProxy(t).changeContent((t=>(null!=t&&delete t[this.getDefinitionID(e)],t)))}async getIndex(e=this.id){const t=this.authenticated&&e===this.id?await this._getIndexProxy(e).get():await this._getIDXDoc(e);return t?t.content:null}iterator(e){let t,r=0;return{[Symbol.asyncIterator](){return this},next:async()=>{if(null==t){const r=await this.getIndex(e);t=Object.entries(r??{})}if(r===t.length)return{done:!0,value:null};const[n,o]=t[r++];return{done:!1,value:{key:n,id:o,record:(await us(this,ys).load(o)).content}}}}}async _createIDXDoc(e){return await us(this,ys).deterministic(ss(e))}async _getIDXDoc(e){const t=await this._createIDXDoc(e);if(null==t.content||null==t.metadata.schema)return null;if(t.metadata.schema!==Wa)throw new Error("Invalid document: schema is not IdentityIndex");return t}async _getOwnIDXDoc(e){const t=await this._createIDXDoc(e);if(null==t.content||null==t.metadata.schema)await t.update({},{schema:Wa});else if(t.metadata.schema!==Wa)throw new Error("Invalid document: schema is not IdentityIndex");return t}_getIndexProxy(e){let t=us(this,ps)[e];return null==t&&(t=new os((async()=>await this._getOwnIDXDoc(e))),us(this,ps)[e]=t),t}getDefinitionID(e){return us(this,ms).getDefinitionID(e)??e}async getDefinition(e){const t=await us(this,ys).load(e);if("ceramic://k3y52l7qbv1fry1fp4s0nwdarh0vahusarpposgevy0pemiykymd2ord6swtharcw"!==t.metadata.schema)throw new Error("Invalid document: schema is not Definition");return{...t.content,id:t.id}}async getRecordID(e,t){return(await this.getIndex(t??this.id))?.[e]??null}async getRecordDocument(e,t){const r=await this.getRecordID(e,t);return r?await us(this,ys).load(r):null}async getRecord(e,t){const r=await this.getRecordDocument(e,t);return r?r.content:null}async setRecord(e,t,r={}){const[n,o]=await this._setRecordOnly(e,t,r);return n&&await this._setReference(r.controller??this.id,e,o),o}async _setRecordOnly(e,t,r){const n=await this.getRecordID(e,r.controller??this.id);if(null==n){const n=await this.getDefinition(e);return[!0,await this._createRecord(n,t,r)]}return[!1,(await us(this,ys).update(n,t)).id]}async _createRecord(e,t,{controller:r,pin:n}){const o=await us(this,ys).deterministic({controllers:[r??this.id],family:e.id.toString()},{pin:n});return await o.update(t,{schema:e.schema}),o.id}async _setReference(e,t,r){await this._getIndexProxy(e).changeContent((e=>({...e,[t]:r.toUrl()})))}async _setReferences(e,t){0!==Object.keys(t).length&&await this._getIndexProxy(e).changeContent((e=>({...e,...t})))}constructor(e){ls(this,hs,{writable:!0,value:void 0}),ls(this,ds,{writable:!0,value:void 0}),ls(this,ps,{writable:!0,value:{}}),ls(this,ys,{writable:!0,value:void 0}),ls(this,ms,{writable:!0,value:void 0});const{cache:t,ceramic:r,id:n,loader:o,model:i}=e;fs(this,hs,r),fs(this,ds,n),fs(this,ys,o??new $a({ceramic:r,cache:t})),fs(this,ms,i instanceof Ka?i:new Ka({loader:us(this,ys),aliases:i}))}}function bs(e,t){const r=`did:key:${t}`,n=`${r}#${t}`;return{id:r,verificationMethod:[{id:n,type:"Secp256k1VerificationKey2018",controller:r,publicKeyBase58:on(e,"base58btc")}],authentication:[n],assertionMethod:[n],capabilityDelegation:[n],capabilityInvocation:[n]}}var vs=r(50);function gs(e,t){const r=`did:key:${t}`,n=`${r}#${t}`,o=(0,vs.SH)(e),i=`${r}#${function(e){const t=new Uint8Array(e.length+2);return t[0]=236,t[1]=1,t.set(e,2),`z${on(t,"base58btc")}`}(o)}`;return{id:r,verificationMethod:[{id:n,type:"Ed25519VerificationKey2018",controller:r,publicKeyBase58:on(e,"base58btc")}],authentication:[n],assertionMethod:[n],capabilityDelegation:[n],capabilityInvocation:[n],keyAgreement:[{id:i,type:"X25519KeyAgreementKey2019",controller:r,publicKeyBase58:on(o,"base58btc")}]}}function Es(e,t){if("number"==typeof e&&(e=BigInt(e)),"number"==typeof t&&(t=BigInt(t)),t<=0n)throw new RangeError("n must be > 0");const r=e%t;return r<0n?r+t:r}function _s(e,t,r){if("number"==typeof e&&(e=BigInt(e)),"number"==typeof t&&(t=BigInt(t)),"number"==typeof r&&(r=BigInt(r)),r<=0n)throw new RangeError("n must be > 0");if(1n===r)return 0n;if(e=Es(e,r),t<0n)return function(e,t){const r=function(e,t){if("number"==typeof e&&(e=BigInt(e)),"number"==typeof t&&(t=BigInt(t)),e<=0n||t<=0n)throw new RangeError("a and b MUST be > 0");let r=0n,n=1n,o=1n,i=0n;for(;0n!==e;){const a=t/e,s=t%e,c=r-o*a,u=n-i*a;t=e,e=s,r=o,n=i,o=c,i=u}return{g:t,x:r,y:n}}(Es(e,t),t);if(1n!==r.g)throw new RangeError(`${e.toString()} does not have inverse modulo ${t.toString()}`);return Es(r.x,t)}(_s(e,(n=t)>=0?n:-n,r),r);var n;let o=1n;for(;t>0;)t%2n===1n&&(o=o*e%r),t/=2n,e=e**2n%r;return o}function Ss(e){if(!xs(e))throw new TypeError("input must be a Uint8Array");return on(e,"base16")}function As(e){if(!Is(e))throw new TypeError("input must be string with characters 0-9,A-F,a-f");const t=function(e){if(!Is(e))throw new TypeError("input must be string with characters 0-9,A-F,a-f");const t=e.slice(0,e.length/2),r=e.slice(e.length/2,e.length);return{xOctet:nn(t,"base16"),yOctet:nn(r,"base16")}}(e);return{xm:Pr.encode(t.xOctet).slice(1),ym:Pr.encode(t.yOctet).slice(1)}}function Is(e){const t=new RegExp(/^[A-Fa-f0-9]+/i);return!(!t.test(e)||e.length!=t.exec(e)[0].length)}function xs(e){return null!=e&&e.constructor===Uint8Array}function Os(e){if(null==e)throw new TypeError("input cannot be null or undefined.");if("object"!=typeof e)throw new TypeError("Input must be an object with properties x and y");if(!Object.prototype.hasOwnProperty.call(e,"x")||!Object.prototype.hasOwnProperty.call(e,"y"))throw new Error("Input must have properties x and y");if("bigint"!=typeof e.x&&"bigint"!=typeof e.y)throw new Error("Input coordinates must be BigInt");const t=function(e){if(null==e)throw new TypeError("input cannot be null or undefined.");if("object"!=typeof e)throw new TypeError("Input must be an object with properties x and y");if(!Object.prototype.hasOwnProperty.call(e,"x")||!Object.prototype.hasOwnProperty.call(e,"y"))throw new Error("Input must have properties x and y");if("bigint"!=typeof e.x&&"bigint"!=typeof e.y)throw new Error("Input coordinates must be BigInt");const t=e.x.toString(),r=e.y.toString();return{xOctet:nn(t,"base10"),yOctet:nn(r,"base10")}}(e);return{xm:Pr.encode(t.xOctet).slice(1),ym:Pr.encode(t.yOctet).slice(1)}}function ks(e,t){const r=`did:key:${t}`,n=`${r}#${t}`,o=js(e);return{id:r,verificationMethod:[{id:n,type:"JsonWebKey2020",controller:r,publicKeyJwk:{kty:"EC",crv:"P-256",x:o.xm,y:o.ym}}],authentication:[n],assertionMethod:[n],capabilityDelegation:[n],capabilityInvocation:[n]}}function Cs(e){if(!xs(e))throw new TypeError("input must be a Uint8Array");const t=BigInt(2),r=t**256n-t**224n+t**192n+t**96n-1n,n=(r+1n)/4n,o=BigInt(e[0]-2),i=e.subarray(1),a=BigInt(on(i,"base10"));let s=_s(a**3n-3n*a+41058363725152142129326129780047268409114441015993725554835256314039467401291n,n,r);return s%2n!==o&&(s=r-s),{x:a,y:s}}function js(e){if(!xs(e))throw new TypeError("input must be a Uint8Array");const t=Ss(e),r=t.length/2;if(64==r)return As(t);if(65==r&&"04"==t.slice(0,2))return As(t.slice(2));if(33==r&&("03"==t.slice(0,2)||"02"==t.slice(0,2)))return Os(Cs(nn(t,"base16")));throw new Error("Unexpected pubKeyBytes")}function Ds(e,t){const r=`did:key:${t}`,n=`${r}#${t}`,o=Ps(e);return{id:r,verificationMethod:[{id:n,type:"JsonWebKey2020",controller:r,publicKeyJwk:{kty:"EC",crv:"P-384",x:o.xm,y:o.ym}}],authentication:[n],assertionMethod:[n],capabilityDelegation:[n],capabilityInvocation:[n]}}function Ts(e){if(!xs(e))throw new TypeError("input must be a Uint8Array");const t=BigInt(2),r=t**384n-t**128n-t**96n+t**32n-1n,n=(r+1n)/4n,o=BigInt(e[0]-2),i=e.subarray(1),a=BigInt(on(i,"base10"));let s=_s(a**3n-3n*a+27580193559959705877849011840389048093056905856361568521428707301988689241309860865136260764883745107765439761230575n,n,r);return s%2n!==o&&(s=r-s),{x:a,y:s}}function Ps(e){if(!xs(e))throw new TypeError("input must be a Uint8Array");const t=Ss(e),r=t.length/2;if(96==r)return As(t);if(97==r&&"04"==t.slice(0,2))return As(t.slice(2));if(49==r&&("03"==t.slice(0,2)||"02"==t.slice(0,2)))return Os(Ts(nn(t,"base16")));throw new Error("Unexpected pubKeyBytes")}function Rs(e,t){const r=`did:key:${t}`,n=`${r}#${t}`,o=Bs(e);return{id:r,verificationMethod:[{id:n,type:"JsonWebKey2020",controller:r,publicKeyJwk:{kty:"EC",crv:"P-521",x:o.xm,y:o.ym}}],authentication:[n],assertionMethod:[n],capabilityDelegation:[n],capabilityInvocation:[n]}}function Ns(e){if(!xs(e))throw new TypeError("input must be a Uint8Array");const t=BigInt(2)**521n-1n,r=(t+1n)/4n,n=BigInt(e[0]-2),o=e.subarray(1),i=BigInt(on(o,"base10"));let a=_s(i**3n-3n*i+1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984n,r,t);return a%2n!==n&&(a=t-a),{x:i,y:a}}function Bs(e){if(!xs(e))throw new TypeError("input must be a Uint8Array");const t=Ss(e);if(132<=t.length&&t.length<=134&&("03"==t.slice(0,2)||"02"==t.slice(0,2)))return Os(Ns(nn(t,"base16")));throw new Error("Unexpected pubKeyBytes")}const Us="application/did+json",Ms={231:b,237:v,4608:g,4609:E,4610:_};const Ls={definitions:{cryptoAccounts:"kjzl6cwe1jw149z4rvwzi56mjjukafta30kojzktd9dsrgqdgz4wlnceu59f95f",alsoKnownAs:"kjzl6cwe1jw146zfmqa10a5x1vry6au3t362p44uttz4l0k4hi88o41zplhmxnf",basicProfile:"kjzl6cwe1jw145cjbeko9kil8g9bxszjhyde21ob8epxuxkaon1izyqsu8wgcic"},schemas:{CryptoAccounts:"ceramic://k3y52l7qbv1frypussjburqg4fykyyycfu0p9znc75lv2t5cg4xaslhagkd7h7mkg",AlsoKnownAs:"ceramic://k3y52l7qbv1fryojt8n8cw2k04p9wp67ly59iwqs65dejso566fij5wsdrb871yio",BasicProfile:"ceramic://k3y52l7qbv1frxt706gqfzmq6cbqdkptzk8uudaryhlkf6ly9vx21hqu4r6k1jqio"},tiles:{}};function Fs(){return Fs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fs.apply(this,arguments)}var $s={name:"chainId",regex:"[-:a-zA-Z0-9]{5,41}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,32}"}}}},zs={name:"assetName",regex:"[-:a-zA-Z0-9]{5,73}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,64}"}}}},Hs={2:$s,10:{name:"accountId",regex:"[-:a-zA-Z0-9]{7,106}",parameters:{delimiter:":",values:{0:{name:"namespace",regex:"[-a-z0-9]{3,8}"},1:{name:"reference",regex:"[-a-zA-Z0-9]{1,32}"},2:{name:"address",regex:"[a-zA-Z0-9]{1,64}"}}}},19:{assetName:zs,assetType:{name:"assetType",regex:"[-:a-zA-Z0-9]{11,115}",parameters:{delimiter:"/",values:{0:$s,1:zs}}},assetId:{name:"assetId",regex:"[-:a-zA-Z0-9]{13,148}",parameters:{delimiter:"/",values:{0:$s,1:zs,2:{name:"tokenId",regex:"[-a-zA-Z0-9]{1,32}"}}}}}};function qs(e,t){return e.split(t.parameters.delimiter)}function Vs(e,t){var r=qs(e,t),n={};return r.forEach((function(e,r){n[t.parameters.values[r].name]=e})),n}function Js(e,t){return Object.values(t.parameters.values).map((function(t){var r=e[t.name];return"string"==typeof r?r:Js(r,t)})).join(t.parameters.delimiter)}function Gs(e,t){if(!new RegExp(t.regex).test(e))return!1;var r=qs(e,t);return r.length===Object.keys(t.parameters.values).length&&r.map((function(e,r){return new RegExp(t.parameters.values[r].regex).test(e)})).filter((function(e){return!!e})).length===r.length}var Ks=function(){function e(t){"string"==typeof t&&(t=e.parse(t)),this.namespace=t.namespace,this.reference=t.reference}e.parse=function(t){if(!Gs(t,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+t);return new e(Vs(t,this.spec)).toJSON()},e.format=function(e){return Js(e,this.spec)};var t=e.prototype;return t.toString=function(){return e.format(this.toJSON())},t.toJSON=function(){return{namespace:this.namespace,reference:this.reference}},e}();Ks.spec=Hs[2];var Ws=function(){function e(t){"string"==typeof t&&(t=e.parse(t)),this.chainId=new Ks(t.chainId),this.address=t.address}e.parse=function(t){if(!Gs(t,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+t);var r=Vs(t,this.spec),n=r.namespace,o=r.reference,i=r.address;return new e({chainId:new Ks({namespace:n,reference:o}),address:i}).toJSON()},e.format=function(e){return Js(Fs({},new Ks(e.chainId).toJSON(),{address:e.address}),this.spec)};var t=e.prototype;return t.toString=function(){return e.format(this.toJSON())},t.toJSON=function(){return{chainId:this.chainId.toJSON(),address:this.address}},e}();Ws.spec=Hs[10];var Ys=function(){function e(t){"string"==typeof t&&(t=e.parse(t)),this.namespace=t.namespace,this.reference=t.reference}e.parse=function(t){if(!Gs(t,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+t);return new e(Vs(t,this.spec)).toJSON()},e.format=function(e){return Js(e,this.spec)};var t=e.prototype;return t.toString=function(){return e.format(this.toJSON())},t.toJSON=function(){return{namespace:this.namespace,reference:this.reference}},e}();function Zs(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function Xs(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,Zs(e,t,"get"))}function Qs(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function ec(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,Zs(e,t,"set"),r),r}Ys.spec=Hs[19].assetName,(function(){function e(t){"string"==typeof t&&(t=e.parse(t)),this.chainId=new Ks(t.chainId),this.assetName=new Ys(t.assetName)}e.parse=function(t){if(!Gs(t,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+t);return new e(Vs(t,this.spec)).toJSON()},e.format=function(e){return Js(e,this.spec)};var t=e.prototype;return t.toString=function(){return e.format(this.toJSON())},t.toJSON=function(){return{chainId:this.chainId.toJSON(),assetName:this.assetName}},e}()).spec=Hs[19].assetType,(function(){function e(t){"string"==typeof t&&(t=e.parse(t)),this.chainId=new Ks(t.chainId),this.assetName=new Ys(t.assetName),this.tokenId=t.tokenId}e.parse=function(t){if(!Gs(t,this.spec))throw new Error("Invalid "+this.spec.name+" provided: "+t);return new e(Vs(t,this.spec)).toJSON()},e.format=function(e){return Js(e,this.spec)};var t=e.prototype;return t.toString=function(){return e.format(this.toJSON())},t.toJSON=function(){return{chainId:this.chainId.toJSON(),assetName:this.assetName.toJSON(),tokenId:this.tokenId}},e}()).spec=Hs[19].assetId;const tc={local:"http://localhost:7007","mainnet-gateway":"https://gateway.ceramic.network","testnet-clay":"https://ceramic-clay.3boxlabs.com","testnet-clay-gateway":"https://gateway-clay.ceramic.network"};var rc=new WeakMap,nc=new WeakMap,oc=new WeakMap;class ic{get ceramic(){return this._ceramic}get dataModel(){return Xs(this,rc)}get dataStore(){return this._dataStore}get resolver(){return Xs(this,nc)}get tileLoader(){return Xs(this,oc)}async getAccountDID(e){const t=await Sa.fromAccount(this._ceramic,e);if(null==t.did)throw new Error(`No DID found for ${e}`);return t.did}async toDID(e){return as(e)?e:function(e){try{return Ws.parse(e),!0}catch(e){return!1}}(e)?await this.getAccountDID(e):e}async get(e,t){const r=await this.toDID(t);return await this._dataStore.get(e,r)}constructor(e){Qs(this,rc,{writable:!0,value:void 0}),Qs(this,nc,{writable:!0,value:void 0}),Qs(this,oc,{writable:!0,value:void 0});const t=new Ca(tc[e.ceramic]??e.ceramic),r=e.loader??new $a({ceramic:t,cache:e.cache});this._ceramic=t,ec(this,rc,new Ka({loader:r,aliases:e.aliases??Ls})),this._dataStore=new ws({ceramic:t,loader:r,model:Xs(this,rc)}),ec(this,nc,new ma({key:async(e,t,r,n)=>{const o=n.accept||Us,i={didResolutionMetadata:{contentType:o},didDocument:null,didDocumentMetadata:{}};try{const e=Gt.decode(t.id),r=dn.decode(e),n=e.slice(dn.decode.bytes),a=await Ms[r].keyToDidDoc(n,t.id);"application/did+ld+json"===o?(a["@context"]="https://w3id.org/did/v1",i.didDocument=a):o===Us?i.didDocument=a:(delete i.didResolutionMetadata.contentType,i.didResolutionMetadata.error="representationNotSupported")}catch(e){i.didResolutionMetadata.error="invalidDid",i.didResolutionMetadata.message=e.toString()}return i},...ni(this._ceramic)})),ec(this,oc,r)}}class ac{constructor(e){this._core=new ic({ceramic:e??"https://ceramic-clay.3boxlabs.com",aliases:{definitions:{Passport:"kjzl6cwe1jw14b5pv8zucigpz0sc2lh9z5l0ztdrvqw5y1xt2tvz8cjt34bkub9",VerifiableCredential:"kjzl6cwe1jw147bsnnxvupgywgr0tyi7tesgle7e4427hw2dn8sp9dnsltvey1n"},schemas:{Passport:"ceramic://k3y52l7qbv1frygm3lu9o9qra3nid11t6vuj0mas2m1mmlywh0fop5tgrxf060000",VerifiableCredential:"ceramic://k3y52l7qbv1frxunk7h39a05iup0s5sheycsgi8ozxme1s3tl37modhalv38d05q8"},tiles:{}}})}async getDID(e){let t;try{t=await this._core.getAccountDID(`${e}@eip155:1`)}catch{t=!1}return t}async getPassport(e){const t=await this.getPassportStream(e);if(t){const e=await this.getStamps(t);return{issuanceDate:t.issuanceDate,expiryDate:t.expiryDate,stamps:e}}return t}async getStamps(e){const t=e?.stamps||[];return await Promise.all(t.map((async e=>await this.getStampStream(e))))}async getPassportStream(e){let t;try{t=await this._core.get("Passport",e)}catch{t=!1}return t}async getStampStream(e){let t;try{t={provider:e.provider,credential:await(await this._core._ceramic.loadStream(e.credential)).content}}catch{t=!1}return t}}})(),n.default})()));